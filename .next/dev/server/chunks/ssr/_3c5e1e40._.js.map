{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/components/admin/TwoFactorSetup.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { Loader2, CheckCircle, AlertTriangle } from \"lucide-react\";\r\n\r\nexport default function TwoFactorSetup() {\r\n  const [loading, setLoading] = useState(false);\r\n  const [factorId, setFactorId] = useState<string | null>(null);\r\n  const [qrCode, setQrCode] = useState<string | null>(null);\r\n  const [verifyCode, setVerifyCode] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [isEnabled, setIsEnabled] = useState(false);\r\n\r\n  useEffect(() => {\r\n    async function checkStatus() {\r\n      const { data } = await supabase.auth.mfa.listFactors();\r\n      const totp = data?.all?.find((f) => f.factor_type === 'totp' && f.status === 'verified');\r\n      if (totp) setIsEnabled(true);\r\n    }\r\n    checkStatus();\r\n  }, []);\r\n\r\n  const startSetup = async () => {\r\n    setLoading(true);\r\n    setError(\"\");\r\n    \r\n    try {\r\n      const { data, error } = await supabase.auth.mfa.enroll({\r\n        factorType: 'totp', \r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      setFactorId(data.id);\r\n      setQrCode(data.totp.qr_code); \r\n    } catch (err: any) {\r\n      setError(err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const verifySetup = async () => {\r\n    if (!factorId) return;\r\n    setLoading(true);\r\n    setError(\"\");\r\n\r\n    try {\r\n      const { data: challenge, error: challengeError } = await supabase.auth.mfa.challenge({\r\n        factorId: factorId,\r\n      });\r\n\r\n      if (challengeError) throw challengeError;\r\n\r\n      const { error: verifyError } = await supabase.auth.mfa.verify({\r\n        factorId: factorId,\r\n        challengeId: challenge.id,\r\n        code: verifyCode,\r\n      });\r\n\r\n      if (verifyError) throw verifyError;\r\n\r\n      setIsEnabled(true);\r\n      setQrCode(null);\r\n      setVerifyCode(\"\");\r\n      alert(\"Success! 2FA is now active.\");\r\n\r\n    } catch (err: any) {\r\n      setError(\"Invalid code. Please try again.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const disable2FA = async () => {\r\n    if(!confirm(\"Are you sure? Your account will be less secure.\")) return;\r\n    const { data } = await supabase.auth.mfa.listFactors();\r\n    const totp = data?.all?.find(f => f.factor_type === 'totp');\r\n    if (totp) {\r\n        await supabase.auth.mfa.unenroll({ factorId: totp.id });\r\n        setIsEnabled(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 bg-gray-900 border border-gray-800 rounded-2xl max-w-md\">\r\n      <h3 className=\"text-xl font-bold text-white mb-4 flex items-center gap-2\">\r\n        Two-Factor Authentication\r\n        {isEnabled && <CheckCircle className=\"text-emerald-500\" size={20}/>}\r\n      </h3>\r\n\r\n      {isEnabled ? (\r\n        <div className=\"bg-emerald-900/20 border border-emerald-900 p-4 rounded-xl text-emerald-400 mb-4\">\r\n          <p className=\"font-bold text-sm\">âœ“ Your account is secure.</p>\r\n          <button onClick={disable2FA} className=\"text-xs text-red-400 hover:underline mt-2\">Disable 2FA</button>\r\n        </div>\r\n      ) : (\r\n        <p className=\"text-gray-400 text-sm mb-6\">\r\n          Protect your account with Google Authenticator.\r\n        </p>\r\n      )}\r\n\r\n      {error && (\r\n        <div className=\"bg-red-900/20 text-red-400 p-3 rounded-lg text-sm mb-4 flex items-center gap-2\">\r\n           <AlertTriangle size={16}/> {error}\r\n        </div>\r\n      )}\r\n\r\n      {!isEnabled && !qrCode && (\r\n        <button \r\n          onClick={startSetup} \r\n          disabled={loading}\r\n          className=\"w-full py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-bold transition\"\r\n        >\r\n          {loading ? \"Generating...\" : \"Enable 2FA\"}\r\n        </button>\r\n      )}\r\n\r\n      {qrCode && (\r\n        <div className=\"space-y-4\">\r\n          <div className=\"bg-white p-4 rounded-xl inline-block\">\r\n             <img src={qrCode} alt=\"Scan this QR\" className=\"w-40 h-40\" />\r\n          </div>\r\n          <p className=\"text-sm text-gray-400\">1. Scan this with Google Authenticator.</p>\r\n          <p className=\"text-sm text-gray-400\">2. Enter the code below.</p>\r\n          \r\n          <input \r\n             type=\"text\" \r\n             placeholder=\"123456\" \r\n             className=\"w-full bg-gray-800 border border-gray-700 text-white p-3 rounded-lg tracking-widest text-center text-xl font-mono\"\r\n             maxLength={6}\r\n             value={verifyCode}\r\n             onChange={e => setVerifyCode(e.target.value)}\r\n          />\r\n\r\n          <button \r\n            onClick={verifySetup} \r\n            disabled={loading || verifyCode.length !== 6}\r\n            className=\"w-full py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-bold transition disabled:opacity-50\"\r\n          >\r\n            {loading ? <Loader2 className=\"animate-spin mx-auto\"/> : \"Verify & Activate\"}\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 248, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/circle-check-big.js","sources":["file:///C:/Users/Kaelo/store-link/node_modules/lucide-react/src/icons/circle-check-big.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M21.801 10A10 10 0 1 1 17 3.335', key: 'yps3ct' }],\n  ['path', { d: 'm9 11 3 3L22 4', key: '1pflzl' }],\n];\n\n/**\n * @component @name CircleCheckBig\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEuODAxIDEwQTEwIDEwIDAgMSAxIDE3IDMuMzM1IiAvPgogIDxwYXRoIGQ9Im05IDExIDMgM0wyMiA0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/circle-check-big\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst CircleCheckBig = createLucideIcon('circle-check-big', __iconNode);\n\nexport default CircleCheckBig;\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAmC,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IAChE;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAkB,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;CACjD;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,cAAA,CAAA,CAAA,KAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,8JAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAoB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA"}},
    {"offset": {"line": 293, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/triangle-alert.js","sources":["file:///C:/Users/Kaelo/store-link/node_modules/lucide-react/src/icons/triangle-alert.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'm21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3',\n      key: 'wmoenq',\n    },\n  ],\n  ['path', { d: 'M12 9v4', key: 'juzpu7' }],\n  ['path', { d: 'M12 17h.01', key: 'p32p05' }],\n];\n\n/**\n * @component @name TriangleAlert\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMjEuNzMgMTgtOC0xNGEyIDIgMCAwIDAtMy40OCAwbC04IDE0QTIgMiAwIDAgMCA0IDIxaDE2YTIgMiAwIDAgMCAxLjczLTMiIC8+CiAgPHBhdGggZD0iTTEyIDl2NCIgLz4KICA8cGF0aCBkPSJNMTIgMTdoLjAxIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/triangle-alert\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst TriangleAlert = createLucideIcon('triangle-alert', __iconNode);\n\nexport default TriangleAlert;\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QACE,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QACA;YACE,CAAA,EAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YACH,GAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA;KAET;IACA;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAW,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IACxC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAc,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;CAC7C;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,aAAA,CAAA,CAAA,KAAgB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,8JAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAkB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA"}}]
}