{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/context/CartContext.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { createContext, useContext, useState, useEffect, ReactNode } from \"react\";\r\nimport { Product, Store } from \"@/types\";\r\n\r\nexport type CartItem = { \r\n  product: Product; \r\n  store: Store; \r\n  qty: number \r\n};\r\n\r\ninterface CartContextType {\r\n  cart: CartItem[];\r\n  isCartOpen: boolean;\r\n  openCart: () => void;\r\n  closeCart: () => void;\r\n  addToCart: (product: Product, store: Store) => void;\r\n  removeFromCart: (productId: string) => void;\r\n  clearCart: () => void;\r\n  cartCount: number;\r\n}\r\n\r\nconst CartContext = createContext<CartContextType | undefined>(undefined);\r\n\r\nexport function CartProvider({ children }: { children: ReactNode }) {\r\n  const [cart, setCart] = useState<CartItem[]>([]);\r\n  const [isCartOpen, setIsCartOpen] = useState(false);\r\n\r\n  // 1. Load Cart from LocalStorage on mount\r\n  useEffect(() => {\r\n    const savedCart = localStorage.getItem(\"storelink_cart\");\r\n    if (savedCart) {\r\n      try {\r\n        setCart(JSON.parse(savedCart));\r\n      } catch (e) {\r\n        console.error(\"Failed to parse cart\", e);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // 2. Save Cart to LocalStorage whenever it changes\r\n  useEffect(() => {\r\n    localStorage.setItem(\"storelink_cart\", JSON.stringify(cart));\r\n  }, [cart]);\r\n\r\n  const addToCart = (product: Product, store: Store) => {\r\n    setCart((prev) => {\r\n      const existing = prev.find((item) => item.product.id === product.id);\r\n      if (existing) {\r\n        // Increment Qty\r\n        return prev.map((item) =>\r\n          item.product.id === product.id ? { ...item, qty: item.qty + 1 } : item\r\n        );\r\n      }\r\n      // Add New\r\n      return [...prev, { product, store, qty: 1 }];\r\n    });\r\n    setIsCartOpen(true); // Auto-open cart on add\r\n  };\r\n\r\n  const removeFromCart = (productId: string) => {\r\n    setCart((prev) => prev.filter((item) => item.product.id !== productId));\r\n  };\r\n\r\n  const clearCart = () => setCart([]);\r\n\r\n  return (\r\n    <CartContext.Provider\r\n      value={{\r\n        cart,\r\n        isCartOpen,\r\n        openCart: () => setIsCartOpen(true),\r\n        closeCart: () => setIsCartOpen(false),\r\n        addToCart,\r\n        removeFromCart,\r\n        clearCart,\r\n        cartCount: cart.reduce((acc, item) => acc + item.qty, 0),\r\n      }}\r\n    >\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n}\r\n\r\nexport const useCart = () => {\r\n  const context = useContext(CartContext);\r\n  if (!context) throw new Error(\"useCart must be used within a CartProvider\");\r\n  return context;\r\n};"],"names":[],"mappings":";;;;;;;AAEA;AAFA;;;AAsBA,MAAM,4BAAc,IAAA,sNAAa,EAA8B;AAExD,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAa,EAAE;IAC/C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,0CAA0C;IAC1C,IAAA,kNAAS,EAAC;QACR,MAAM,YAAY,aAAa,OAAO,CAAC;QACvC,IAAI,WAAW;YACb,IAAI;gBACF,QAAQ,KAAK,KAAK,CAAC;YACrB,EAAE,OAAO,GAAG;gBACV,QAAQ,KAAK,CAAC,wBAAwB;YACxC;QACF;IACF,GAAG,EAAE;IAEL,mDAAmD;IACnD,IAAA,kNAAS,EAAC;QACR,aAAa,OAAO,CAAC,kBAAkB,KAAK,SAAS,CAAC;IACxD,GAAG;QAAC;KAAK;IAET,MAAM,YAAY,CAAC,SAAkB;QACnC,QAAQ,CAAC;YACP,MAAM,WAAW,KAAK,IAAI,CAAC,CAAC,OAAS,KAAK,OAAO,CAAC,EAAE,KAAK,QAAQ,EAAE;YACnE,IAAI,UAAU;gBACZ,gBAAgB;gBAChB,OAAO,KAAK,GAAG,CAAC,CAAC,OACf,KAAK,OAAO,CAAC,EAAE,KAAK,QAAQ,EAAE,GAAG;wBAAE,GAAG,IAAI;wBAAE,KAAK,KAAK,GAAG,GAAG;oBAAE,IAAI;YAEtE;YACA,UAAU;YACV,OAAO;mBAAI;gBAAM;oBAAE;oBAAS;oBAAO,KAAK;gBAAE;aAAE;QAC9C;QACA,cAAc,OAAO,wBAAwB;IAC/C;IAEA,MAAM,iBAAiB,CAAC;QACtB,QAAQ,CAAC,OAAS,KAAK,MAAM,CAAC,CAAC,OAAS,KAAK,OAAO,CAAC,EAAE,KAAK;IAC9D;IAEA,MAAM,YAAY,IAAM,QAAQ,EAAE;IAElC,qBACE,8OAAC,YAAY,QAAQ;QACnB,OAAO;YACL;YACA;YACA,UAAU,IAAM,cAAc;YAC9B,WAAW,IAAM,cAAc;YAC/B;YACA;YACA;YACA,WAAW,KAAK,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,GAAG,EAAE;QACxD;kBAEC;;;;;;AAGP;AAEO,MAAM,UAAU;IACrB,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,CAAC,SAAS,MAAM,IAAI,MAAM;IAC9B,OAAO;AACT"}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/components/shared/GlobalCart.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useCart } from \"@/context/CartContext\";\r\nimport { X, ShoppingBag, MessageCircle, Trash2 } from \"lucide-react\";\r\nimport Image from \"next/image\";\r\n\r\nexport default function GlobalCart() {\r\n  const { cart, isCartOpen, closeCart, removeFromCart } = useCart();\r\n\r\n  if (!isCartOpen) return null;\r\n\r\n  // Group items by Vendor\r\n  const cartByVendor = cart.reduce((acc, item) => {\r\n    const storeId = item.store.id;\r\n    if (!acc[storeId]) acc[storeId] = { store: item.store, items: [] };\r\n    acc[storeId].items.push(item);\r\n    return acc;\r\n  }, {} as Record<string, { store: any; items: any[] }>);\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex justify-end animate-in fade-in duration-200\">\r\n      <div \r\n        className=\"absolute inset-0\" \r\n        onClick={closeCart} \r\n      />\r\n      \r\n      <div className=\"relative w-[90vw] md:w-full md:max-w-md bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300\">\r\n        \r\n        {/* Header */}\r\n        <div className=\"p-5 border-b border-gray-100 flex justify-between items-center bg-gray-50\">\r\n          <h2 className=\"text-lg font-bold flex items-center gap-2\">\r\n            <ShoppingBag size={20} /> Your Bag\r\n          </h2>\r\n          <button onClick={closeCart} className=\"p-2 bg-white rounded-full shadow-sm hover:bg-gray-200 transition\">\r\n            <X size={20} />\r\n          </button>\r\n        </div>\r\n\r\n        {/* List */}\r\n        <div className=\"flex-1 overflow-y-auto p-5\">\r\n          {Object.keys(cartByVendor).length === 0 ? (\r\n            <div className=\"h-full flex flex-col items-center justify-center text-gray-400 space-y-4\">\r\n              <ShoppingBag size={48} className=\"opacity-20\" />\r\n              <p>Your bag is empty.</p>\r\n              <button onClick={closeCart} className=\"text-emerald-600 font-bold text-sm hover:underline\">Start Shopping</button>\r\n            </div>\r\n          ) : (\r\n            Object.values(cartByVendor).map(({ store, items }) => {\r\n              const storeTotal = items.reduce((sum, item) => sum + (item.product.price * item.qty), 0);\r\n              const vendorNumber = store.whatsapp_number.replace(/\\D/g, '').replace(/^0/, '234');\r\n              const msg = `*New Order via StoreLink Marketplace* ðŸ›ï¸\\n\\n${items.map(i => `- ${i.qty}x ${i.product.name}`).join('\\n')}\\n\\n*Total: â‚¦${storeTotal.toLocaleString()}*`;\r\n              const whatsappLink = `https://wa.me/${vendorNumber}?text=${encodeURIComponent(msg)}`;\r\n\r\n              return (\r\n                <div key={store.id} className=\"mb-6 border border-gray-100 rounded-2xl p-4 bg-white shadow-sm\">\r\n                  {/* Vendor Header */}\r\n                  <div className=\"flex justify-between items-center border-b border-gray-50 pb-3 mb-3\">\r\n                    <h3 className=\"font-bold text-gray-900 text-sm\">{store.name}</h3>\r\n                    <span className=\"text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-md font-bold\">\r\n                       â‚¦{storeTotal.toLocaleString()}\r\n                    </span>\r\n                  </div>\r\n                  \r\n                  {/* Items */}\r\n                  <div className=\"space-y-3\">\r\n                    {items.map(item => (\r\n                      <div key={item.product.id} className=\"flex gap-3\">\r\n                        <div className=\"w-12 h-12 bg-gray-100 rounded-lg relative overflow-hidden shrink-0 border border-gray-200\">\r\n                          {item.product.image_urls?.[0] && <Image src={item.product.image_urls[0]} alt=\"\" fill className=\"object-cover\" />}\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <p className=\"text-xs font-bold text-gray-900 truncate\">{item.product.name}</p>\r\n                          <p className=\"text-xs text-gray-500\">{item.qty} x â‚¦{item.product.price.toLocaleString()}</p>\r\n                        </div>\r\n                        <button onClick={() => removeFromCart(item.product.id)} className=\"text-gray-300 hover:text-red-500 transition self-center\">\r\n                          <Trash2 size={16} />\r\n                        </button>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n\r\n                  {/* Checkout Button */}\r\n                  <a \r\n                    href={whatsappLink} \r\n                    target=\"_blank\" \r\n                    className=\"mt-4 flex items-center justify-center gap-2 w-full bg-gray-900 text-white py-3 rounded-xl font-bold text-xs hover:bg-gray-800 transition\"\r\n                  >\r\n                    <MessageCircle size={16} /> Checkout (â‚¦{storeTotal.toLocaleString()})\r\n                  </a>\r\n                </div>\r\n              );\r\n            })\r\n          )}\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}