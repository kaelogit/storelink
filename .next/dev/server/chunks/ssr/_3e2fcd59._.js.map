{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/utils/imageCompressor.ts"],"sourcesContent":["import imageCompression from 'browser-image-compression';\r\n\r\nexport const compressImage = async (file: File) => {\r\n  const options = {\r\n    maxSizeMB: 0.3,          // Max size: 300KB\r\n    maxWidthOrHeight: 1080,  // Max width/height: 1080px (Standard HD)\r\n    useWebWorker: true,      // Runs faster\r\n  };\r\n\r\n  try {\r\n    const compressedFile = await imageCompression(file, options);\r\n    return compressedFile;\r\n  } catch (error) {\r\n    console.error(\"Image compression failed:\", error);\r\n    return file; // If it fails, return original file so upload doesn't break\r\n  }\r\n};"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,gBAAgB,OAAO;IAClC,MAAM,UAAU;QACd,WAAW;QACX,kBAAkB;QAClB,cAAc;IAChB;IAEA,IAAI;QACF,MAAM,iBAAiB,MAAM,IAAA,sMAAgB,EAAC,MAAM;QACpD,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,MAAM,4DAA4D;IAC3E;AACF"}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/utils/removeBackground.ts"],"sourcesContent":["export async function removeBackground(imageFile: File): Promise<Blob> {\r\n  const formData = new FormData();\r\n  formData.append(\"image_file\", imageFile);\r\n  formData.append(\"size\", \"auto\");\r\n\r\n  const apiKey = process.env.NEXT_PUBLIC_REMOVE_BG_KEY;\r\n\r\n  if (!apiKey) {\r\n    throw new Error(\"Missing remove.bg API Key\");\r\n  }\r\n\r\n  const response = await fetch(\"https://api.remove.bg/v1.0/removebg\", {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"X-Api-Key\": apiKey,\r\n    },\r\n    body: formData,\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to remove background\");\r\n  }\r\n\r\n  return await response.blob(); // Returns the clean image as a Blob\r\n}"],"names":[],"mappings":";;;;AAAO,eAAe,iBAAiB,SAAe;IACpD,MAAM,WAAW,IAAI;IACrB,SAAS,MAAM,CAAC,cAAc;IAC9B,SAAS,MAAM,CAAC,QAAQ;IAExB,MAAM;IAEN;;IAIA,MAAM,WAAW,MAAM,MAAM,uCAAuC;QAClE,QAAQ;QACR,SAAS;YACP,aAAa;QACf;QACA,MAAM;IACR;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,MAAM,SAAS,IAAI,IAAI,oCAAoC;AACpE"}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/components/store/AddProductModal.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { X, Loader2, Trash2, Plus, Lock, Crown, Sparkles } from \"lucide-react\";\r\nimport { compressImage } from \"@/utils/imageCompressor\";\r\nimport { removeBackground } from \"@/utils/removeBackground\"; \r\n\r\ninterface AddProductModalProps {\r\n  storeId: string;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n  productToEdit?: any;\r\n}\r\n\r\nexport default function AddProductModal({ storeId, isOpen, onClose, onSuccess, productToEdit }: AddProductModalProps) {\r\n  const router = useRouter();\r\n  const [loading, setLoading] = useState(false);\r\n  const [categories, setCategories] = useState<{ id: string; name: string }[]>([]);\r\n  \r\n  const [isLimitReached, setIsLimitReached] = useState(false);\r\n  const [isExpired, setIsExpired] = useState(false);\r\n  const [errorMsg, setErrorMsg] = useState(\"\");\r\n  \r\n  const [removeBg, setRemoveBg] = useState(false);\r\n  const [processingImages, setProcessingImages] = useState(false);\r\n  \r\n  const [formData, setFormData] = useState({\r\n    name: \"\",\r\n    price: \"\",\r\n    stock: \"1\",\r\n    description: \"\",\r\n    categoryId: \"\",\r\n  });\r\n  \r\n  const [imageFiles, setImageFiles] = useState<File[]>([]);\r\n  const [previews, setPreviews] = useState<string[]>([]);\r\n  const [existingImages, setExistingImages] = useState<string[]>([]); \r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setRemoveBg(false);\r\n      \r\n      if (productToEdit) {\r\n        setFormData({\r\n          name: productToEdit.name,\r\n          price: productToEdit.price.toString(),\r\n          stock: productToEdit.stock_quantity.toString(),\r\n          description: productToEdit.description || \"\",\r\n          categoryId: productToEdit.category_id || \"\",\r\n        });\r\n        setExistingImages(productToEdit.image_urls || []);\r\n        setPreviews([]);\r\n        setImageFiles([]);\r\n      } else {\r\n        setFormData({ name: \"\", price: \"\", stock: \"1\", description: \"\", categoryId: \"\" });\r\n        setExistingImages([]);\r\n        setPreviews([]);\r\n        setImageFiles([]);\r\n      }\r\n\r\n      const loadData = async () => {\r\n        const { data: cats } = await supabase.from(\"categories\").select(\"*\").eq(\"store_id\", storeId);\r\n        setCategories(cats || []);\r\n\r\n        const { data: store } = await supabase\r\n          .from(\"stores\")\r\n          .select(\"subscription_plan, subscription_expiry\")\r\n          .eq(\"id\", storeId)\r\n          .single();\r\n        \r\n        const plan = store?.subscription_plan || 'free';\r\n        const expiry = store?.subscription_expiry;\r\n\r\n        if (plan !== 'free' && expiry && new Date(expiry) < new Date()) {\r\n           setIsExpired(true);\r\n        } else {\r\n           setIsExpired(false);\r\n        }\r\n\r\n        if (!productToEdit) {\r\n            const { count } = await supabase\r\n              .from(\"products\")\r\n              .select(\"*\", { count: 'exact', head: true }) \r\n              .eq(\"store_id\", storeId);\r\n            \r\n            if (plan === 'free' && (count || 0) >= 5) {\r\n              setIsLimitReached(true);\r\n            } else {\r\n              setIsLimitReached(false);\r\n            }\r\n        } else {\r\n            setIsLimitReached(false); \r\n        }\r\n      };\r\n      \r\n      loadData();\r\n    }\r\n  }, [isOpen, storeId, productToEdit]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const handleFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files) {\r\n      const newRawFiles = Array.from(e.target.files);\r\n      const totalImages = existingImages.length + imageFiles.length + newRawFiles.length;\r\n      \r\n      if (totalImages > 4) {\r\n          setErrorMsg(\"Max 4 images allowed\"); setTimeout(() => setErrorMsg(\"\"), 3000);\r\n          return;\r\n      }\r\n\r\n      if (removeBg) {\r\n        setProcessingImages(true);\r\n        const processedFiles: File[] = [];\r\n        try {\r\n            for (const file of newRawFiles) {\r\n                const blob = await removeBackground(file);\r\n                const newFile = new File([blob], file.name.replace(/\\.[^/.]+$/, \"\") + \".png\", { type: \"image/png\" });\r\n                processedFiles.push(newFile);\r\n            }\r\n            const combinedFiles = [...imageFiles, ...processedFiles];\r\n            setImageFiles(combinedFiles);\r\n            setPreviews(combinedFiles.map(file => URL.createObjectURL(file)));\r\n        } catch (err: any) {\r\n            setErrorMsg(\"Background removal failed. Try another picture\");\r\n        } finally {\r\n            setProcessingImages(false);\r\n        }\r\n      } else {\r\n        const combinedFiles = [...imageFiles, ...newRawFiles];\r\n        setImageFiles(combinedFiles);\r\n        setPreviews(combinedFiles.map(file => URL.createObjectURL(file)));\r\n      }\r\n    }\r\n  };\r\n\r\n  const removeNewImage = (index: number) => {\r\n    const newFiles = imageFiles.filter((_, i) => i !== index);\r\n    setImageFiles(newFiles);\r\n    setPreviews(newFiles.map(file => URL.createObjectURL(file)));\r\n  };\r\n\r\n  const removeExistingImage = (index: number) => {\r\n    setExistingImages(prev => prev.filter((_, i) => i !== index));\r\n  };\r\n\r\n  // --- üî• THE ENGINE: WRITE TO PRODUCTS TABLE ---\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if ((isLimitReached && !productToEdit) || isExpired) return; \r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      const uploadedUrls: string[] = [];\r\n      for (const file of imageFiles) {\r\n        const compressedFile = await compressImage(file);\r\n        const fileName = `${storeId}/${Date.now()}-${Math.random().toString(36).substring(7)}`;\r\n        const { error: uploadErr } = await supabase.storage.from(\"products\").upload(fileName, compressedFile);\r\n        if (uploadErr) throw uploadErr;\r\n        const { data } = supabase.storage.from(\"products\").getPublicUrl(fileName);\r\n        uploadedUrls.push(data.publicUrl);\r\n      }\r\n\r\n      const finalImageUrls = [...existingImages, ...uploadedUrls];\r\n      const newStock = parseInt(formData.stock);\r\n\r\n      if (productToEdit) {\r\n          const updatePayload: any = {\r\n            name: formData.name,\r\n            price: parseFloat(formData.price),\r\n            stock_quantity: newStock,\r\n            description: formData.description,\r\n            category_id: formData.categoryId || null,\r\n            image_urls: finalImageUrls,\r\n          };\r\n\r\n          // ‚ú® PERFECTION: Sync manual stock edits with the 24h visibility logic\r\n          // If the vendor manually sets stock to 0, start the timer.\r\n          if (newStock === 0 && productToEdit.stock_quantity > 0) {\r\n            updatePayload.sold_out_at = new Date().toISOString();\r\n          } \r\n          // If the vendor adds stock to a sold-out item, clear the timer.\r\n          else if (newStock > 0) {\r\n            updatePayload.sold_out_at = null;\r\n          }\r\n\r\n          const { error } = await supabase.from(\"products\").update(updatePayload).eq(\"id\", productToEdit.id);\r\n          if (error) throw error;\r\n\r\n      } else {\r\n          // ‚ú® PERFECTION: Handle initial \"0 stock\" entries\r\n          const { error } = await supabase.from(\"products\").insert({\r\n            store_id: storeId,\r\n            name: formData.name,\r\n            price: parseFloat(formData.price),\r\n            stock_quantity: newStock,\r\n            description: formData.description,\r\n            category_id: formData.categoryId || null,\r\n            image_urls: finalImageUrls,\r\n            is_active: true,\r\n            sold_out_at: newStock === 0 ? new Date().toISOString() : null\r\n          });\r\n          if (error) throw error;\r\n      }\r\n\r\n      router.refresh(); \r\n      onSuccess();\r\n      onClose();\r\n\r\n    } catch (error: any) {\r\n      setErrorMsg(error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in\">\r\n      <div className=\"bg-white w-full max-w-md rounded-3xl overflow-hidden shadow-2xl animate-in slide-in-from-bottom-10 flex flex-col max-h-[90vh]\">\r\n        \r\n        <div className=\"p-5 border-b border-gray-100 flex justify-between items-center bg-gray-50\">\r\n          <h2 className=\"font-bold text-lg text-gray-900 uppercase tracking-tighter italic\">\r\n            {productToEdit ? \"Edit Product\" : \"New Warehouse Item\"}\r\n          </h2>\r\n          <button onClick={onClose} className=\"p-2 bg-white rounded-full shadow-sm text-gray-500 hover:bg-gray-100 transition\"><X size={20} /></button>\r\n        </div>\r\n\r\n        {isExpired ? (\r\n           <div className=\"p-8 text-center flex flex-col items-center justify-center h-full\">\r\n              <div className=\"w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mb-4\"><Lock size={32} className=\"text-red-400\" /></div>\r\n              <h3 className=\"text-xl font-bold text-gray-900 mb-2\">Subscription Expired</h3>\r\n              <button onClick={() => router.push(\"/dashboard/subscription\")} className=\"w-full bg-red-600 text-white py-4 rounded-xl font-bold shadow-lg\">Renew Subscription</button>\r\n           </div>\r\n        ) : (isLimitReached && !productToEdit) ? (\r\n          <div className=\"p-8 text-center flex flex-col items-center justify-center h-full\">\r\n              <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4\"><Crown size={32} className=\"text-yellow-500\" /></div>\r\n              <h3 className=\"text-xl font-bold text-gray-900 mb-2\">Free Limit Reached</h3>\r\n              <button onClick={() => router.push(\"/dashboard/subscription\")} className=\"w-full bg-gray-900 text-white py-4 rounded-xl font-bold shadow-lg flex items-center justify-center gap-2\">\r\n                <Crown size={20} className=\"text-yellow-400\" /> Upgrade Plan\r\n              </button>\r\n          </div>\r\n        ) : (\r\n          <div className=\"p-6 overflow-y-auto\">\r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n              \r\n              <div>\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                    <label className=\"block text-sm font-bold text-gray-700\">Images (Max 4)</label>\r\n                    <button type=\"button\" onClick={() => setRemoveBg(!removeBg)} disabled={processingImages || existingImages.length + previews.length >= 4}\r\n                        className={`flex items-center gap-2 text-xs font-bold px-3 py-1.5 rounded-full transition border ${removeBg ? 'bg-purple-100 text-purple-700 border-purple-200 shadow-sm' : 'bg-gray-50 text-gray-500 border-gray-200'}`}>\r\n                        <Sparkles size={14} className={removeBg ? \"animate-pulse\" : \"\"} /> {removeBg ? \"AI Removal ON\" : \"AI Background Removal\"}\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-4 gap-2\">\r\n                  {existingImages.map((src, index) => (\r\n                    <div key={`existing-${index}`} className=\"aspect-square relative rounded-xl overflow-hidden border border-gray-200\">\r\n                      <img src={src} alt=\"Existing\" className=\"w-full h-full object-cover\" />\r\n                      <button type=\"button\" onClick={() => removeExistingImage(index)} className=\"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full\"><Trash2 size={12} /></button>\r\n                    </div>\r\n                  ))}\r\n                  {previews.map((src, index) => (\r\n                    <div key={`new-${index}`} className=\"aspect-square relative rounded-xl overflow-hidden border border-gray-200 bg-gray-100\">\r\n                      <img src={src} alt=\"Preview\" className=\"w-full h-full object-cover\" />\r\n                      <button type=\"button\" onClick={() => removeNewImage(index)} className=\"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full\"><Trash2 size={12} /></button>\r\n                    </div>\r\n                  ))}\r\n                  {processingImages && (\r\n                    <div className=\"aspect-square rounded-xl border border-gray-200 flex flex-col items-center justify-center bg-purple-50\">\r\n                        <Loader2 className=\"animate-spin text-purple-600 mb-1\" size={20} />\r\n                        <span className=\"text-[10px] font-bold text-purple-600\">AI working...</span>\r\n                    </div>\r\n                  )}\r\n                  {(existingImages.length + previews.length) < 4 && !processingImages && (\r\n                    <label className={`aspect-square rounded-xl border-2 border-dashed flex flex-col items-center justify-center cursor-pointer transition ${removeBg ? 'border-purple-300 bg-purple-50 text-purple-400' : 'border-gray-300 bg-gray-50 text-gray-400 hover:border-gray-900'}`}>\r\n                      {removeBg ? <Sparkles size={24}/> : <Plus size={24}/>}\r\n                      <input type=\"file\" accept=\"image/*\" multiple onChange={handleFileChange} className=\"hidden\" />\r\n                    </label>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-bold text-gray-700 mb-1\">Name</label>\r\n                <input required className=\"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-gray-900\" placeholder=\"Product name\" value={formData.name} onChange={e => setFormData({...formData, name: e.target.value})} />\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-bold text-gray-700 mb-1\">Price (‚Ç¶)</label>\r\n                    <input required type=\"number\" className=\"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-gray-900\" placeholder=\"0\" value={formData.price} onChange={e => setFormData({...formData, price: e.target.value})} />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-bold text-gray-700 mb-1\">Stock</label>\r\n                    <input required type=\"number\" className=\"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-gray-900\" placeholder=\"0\" value={formData.stock} onChange={e => setFormData({...formData, stock: e.target.value})} />\r\n                  </div>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-bold text-gray-700 mb-1\">Category</label>\r\n                <select className=\"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-gray-900\" value={formData.categoryId} onChange={e => setFormData({...formData, categoryId: e.target.value})}>\r\n                  <option value=\"\">Uncategorized</option>\r\n                  {categories.map(cat => <option key={cat.id} value={cat.id}>{cat.name}</option>)}\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-bold text-gray-700 mb-1\">Description</label>\r\n                <textarea maxLength={500} className=\"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl h-24 resize-none outline-none focus:ring-2 focus:ring-gray-900\" placeholder=\"...\" value={formData.description} onChange={e => setFormData({...formData, description: e.target.value})} />\r\n              </div>\r\n              \r\n              {errorMsg && <div className=\"text-red-600 text-xs font-bold text-center bg-red-50 p-2 rounded-lg\">‚ö†Ô∏è {errorMsg}</div>}\r\n              \r\n              <button type=\"submit\" disabled={loading || processingImages} className=\"w-full bg-gray-900 text-white py-4 rounded-xl font-bold shadow-lg active:scale-95 transition disabled:opacity-50\">\r\n                {loading ? <Loader2 className=\"animate-spin mx-auto\" /> : (productToEdit ? \"Update Item\" : \"Save to Warehouse\")}\r\n              </button>\r\n            </form>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 817, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/components/store/CategoryManager.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { X, Trash2, Plus, Loader2 } from \"lucide-react\";\r\n\r\ninterface CategoryManagerProps {\r\n  storeId: string;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSuccess?: () => void; \r\n}\r\n\r\nexport default function CategoryManager({ storeId, isOpen, onClose, onSuccess }: CategoryManagerProps) {\r\n  const [categories, setCategories] = useState<{ id: string; name: string }[]>([]);\r\n  const [newCat, setNewCat] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const loadCats = async () => {\r\n    const { data } = await supabase.from(\"categories\").select(\"*\").eq(\"store_id\", storeId);\r\n    setCategories(data || []);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isOpen) loadCats();\r\n  }, [isOpen]);\r\n\r\n  const addCategory = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!newCat.trim()) return;\r\n    setLoading(true);\r\n\r\n    const { error } = await supabase.from(\"categories\").insert({\r\n      store_id: storeId,\r\n      name: newCat.trim()\r\n    });\r\n\r\n    if (!error && onSuccess) onSuccess(); \r\n\r\n    setNewCat(\"\");\r\n    loadCats(); \r\n    setLoading(false);\r\n  };\r\n\r\n  const deleteCategory = async (id: string) => {\r\n    if (!confirm(\"Delete this category?\")) return;\r\n    const { error } = await supabase.from(\"categories\").delete().eq(\"id\", id);\r\n    \r\n    if (!error && onSuccess) onSuccess(); \r\n    \r\n    loadCats();\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in\">\r\n      <div className=\"bg-white w-full max-w-sm rounded-3xl p-6 shadow-2xl\">\r\n        <div className=\"flex justify-between items-center mb-6\">\r\n          <h2 className=\"font-bold text-lg text-gray-900\">Manage Categories</h2>\r\n          <button onClick={onClose}><X size={20} className=\"text-gray-500\" /></button>\r\n        </div>\r\n\r\n        <form onSubmit={addCategory} className=\"flex gap-2 mb-6\">\r\n          <input \r\n            className=\"flex-1 p-2 border border-gray-200 rounded-lg outline-none focus:ring-2 focus:ring-gray-900 text-sm\"\r\n            placeholder=\"New Category (e.g. Shoes)\"\r\n            value={newCat}\r\n            onChange={(e) => setNewCat(e.target.value)}\r\n          />\r\n          <button disabled={loading} className=\"bg-gray-900 text-white p-2 rounded-lg hover:bg-gray-800\">\r\n            {loading ? <Loader2 size={18} className=\"animate-spin\"/> : <Plus size={18} />}\r\n          </button>\r\n        </form>\r\n\r\n        <div className=\"space-y-2 max-h-60 overflow-y-auto\">\r\n          {categories.length === 0 && <p className=\"text-gray-400 text-sm text-center\">No categories yet.</p>}\r\n          {categories.map((cat) => (\r\n            <div key={cat.id} className=\"flex justify-between items-center p-3 bg-gray-50 rounded-xl\">\r\n              <span className=\"font-medium text-gray-700 text-sm\">{cat.name}</span>\r\n              <button onClick={() => deleteCategory(cat.id)} className=\"text-red-400 hover:text-red-600\"><Trash2 size={16}/></button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAJA;;;;;AAae,SAAS,gBAAgB,EAAE,OAAO,EAAE,MAAM,EAAE,OAAO,EAAE,SAAS,EAAwB;IACnG,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAiC,EAAE;IAC/E,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,MAAM,WAAW;QACf,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,2HAAQ,CAAC,IAAI,CAAC,cAAc,MAAM,CAAC,KAAK,EAAE,CAAC,YAAY;QAC9E,cAAc,QAAQ,EAAE;IAC1B;IAEA,IAAA,kNAAS,EAAC;QACR,IAAI,QAAQ;IACd,GAAG;QAAC;KAAO;IAEX,MAAM,cAAc,OAAO;QACzB,EAAE,cAAc;QAChB,IAAI,CAAC,OAAO,IAAI,IAAI;QACpB,WAAW;QAEX,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,2HAAQ,CAAC,IAAI,CAAC,cAAc,MAAM,CAAC;YACzD,UAAU;YACV,MAAM,OAAO,IAAI;QACnB;QAEA,IAAI,CAAC,SAAS,WAAW;QAEzB,UAAU;QACV;QACA,WAAW;IACb;IAEA,MAAM,iBAAiB,OAAO;QAC5B,IAAI,CAAC,QAAQ,0BAA0B;QACvC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,2HAAQ,CAAC,IAAI,CAAC,cAAc,MAAM,GAAG,EAAE,CAAC,MAAM;QAEtE,IAAI,CAAC,SAAS,WAAW;QAEzB;IACF;IAEA,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAkC;;;;;;sCAChD,8OAAC;4BAAO,SAAS;sCAAS,cAAA,8OAAC,iMAAC;gCAAC,MAAM;gCAAI,WAAU;;;;;;;;;;;;;;;;;8BAGnD,8OAAC;oBAAK,UAAU;oBAAa,WAAU;;sCACrC,8OAAC;4BACC,WAAU;4BACV,aAAY;4BACZ,OAAO;4BACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;;;;;;sCAE3C,8OAAC;4BAAO,UAAU;4BAAS,WAAU;sCAClC,wBAAU,8OAAC,4NAAO;gCAAC,MAAM;gCAAI,WAAU;;;;;qDAAmB,8OAAC,0MAAI;gCAAC,MAAM;;;;;;;;;;;;;;;;;8BAI3E,8OAAC;oBAAI,WAAU;;wBACZ,WAAW,MAAM,KAAK,mBAAK,8OAAC;4BAAE,WAAU;sCAAoC;;;;;;wBAC5E,WAAW,GAAG,CAAC,CAAC,oBACf,8OAAC;gCAAiB,WAAU;;kDAC1B,8OAAC;wCAAK,WAAU;kDAAqC,IAAI,IAAI;;;;;;kDAC7D,8OAAC;wCAAO,SAAS,IAAM,eAAe,IAAI,EAAE;wCAAG,WAAU;kDAAkC,cAAA,8OAAC,oNAAM;4CAAC,MAAM;;;;;;;;;;;;+BAFjG,IAAI,EAAE;;;;;;;;;;;;;;;;;;;;;;AAS5B"}},
    {"offset": {"line": 1010, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/components/dashboard/ShareStore.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { Copy, Check, Share2, QrCode, X, Download } from \"lucide-react\";\r\nimport { QRCodeSVG } from \"qrcode.react\";\r\n\r\nexport default function ShareStore({ slug }: { slug: string }) {\r\n  const [copied, setCopied] = useState(false);\r\n  const [showQR, setShowQR] = useState(false);\r\n\r\n  const storeUrl = `https://storelink.ng/${slug}`;\r\n\r\n  const handleCopy = () => {\r\n    navigator.clipboard.writeText(storeUrl);\r\n    setCopied(true);\r\n    setTimeout(() => setCopied(false), 2000);\r\n  };\r\n\r\n  const downloadQR = () => {\r\n     const svg = document.getElementById(\"store-qr-code\");\r\n     if (svg) {\r\n        const svgData = new XMLSerializer().serializeToString(svg);\r\n        const canvas = document.createElement(\"canvas\");\r\n        const ctx = canvas.getContext(\"2d\");\r\n        const img = new Image();\r\n        img.onload = () => {\r\n           canvas.width = img.width;\r\n           canvas.height = img.height;\r\n           ctx?.drawImage(img, 0, 0);\r\n           const pngFile = canvas.toDataURL(\"image/png\");\r\n           const downloadLink = document.createElement(\"a\");\r\n           downloadLink.download = `${slug}-qr.png`;\r\n           downloadLink.href = pngFile;\r\n           downloadLink.click();\r\n        };\r\n        img.src = \"data:image/svg+xml;base64,\" + btoa(svgData);\r\n     }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"bg-gradient-to-br from-emerald-900 to-emerald-700 rounded-3xl p-6 text-white shadow-lg relative overflow-hidden\">\r\n         <div className=\"relative z-10\">\r\n            <h3 className=\"font-bold text-lg mb-1 flex items-center gap-2\">\r\n               <Share2 size={20} className=\"text-emerald-300\"/> Share Your Store\r\n            </h3>\r\n            <p className=\"text-emerald-100 text-sm mb-4\">Get customers to visit your link.</p>\r\n            \r\n            <div className=\"flex gap-2\">\r\n                <button \r\n                  onClick={handleCopy} \r\n                  className=\"flex-1 bg-white/10 hover:bg-white/20 backdrop-blur-md border border-white/20 py-2.5 rounded-xl font-bold text-sm transition flex items-center justify-center gap-2\"\r\n                >\r\n                   {copied ? <Check size={16} /> : <Copy size={16} />} \r\n                   {copied ? \"Copied!\" : \"Copy Link\"}\r\n                </button>\r\n                <button \r\n                   onClick={() => setShowQR(true)}\r\n                   className=\"bg-white text-emerald-900 py-2.5 px-4 rounded-xl font-bold text-sm hover:bg-emerald-50 transition flex items-center gap-2\"\r\n                >\r\n                   <QrCode size={16} /> QR Code\r\n                </button>\r\n            </div>\r\n         </div>\r\n         \r\n         <Share2 size={120} className=\"absolute -bottom-6 -right-6 text-white/5 rotate-12\" />\r\n      </div>\r\n\r\n      {showQR && (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-in fade-in\">\r\n           <div className=\"bg-white w-full max-w-sm rounded-3xl p-6 text-center relative animate-in zoom-in-95\">\r\n              <button \r\n                onClick={() => setShowQR(false)} \r\n                className=\"absolute top-4 right-4 p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition\"\r\n              >\r\n                 <X size={20} />\r\n              </button>\r\n\r\n              <h3 className=\"font-bold text-xl text-gray-900 mb-2\">Your Store QR Code</h3>\r\n              <p className=\"text-gray-500 text-sm mb-6\">Customers can scan this to visit your store immediately.</p>\r\n\r\n              <div className=\"bg-white p-4 rounded-2xl border-2 border-gray-100 inline-block mb-6 shadow-sm\">\r\n                 <QRCodeSVG \r\n                    id=\"store-qr-code\"\r\n                    value={storeUrl} \r\n                    size={200} \r\n                    level={\"H\"}\r\n                    includeMargin={true}\r\n                 />\r\n              </div>\r\n\r\n              <div className=\"flex gap-2\">\r\n                 <button onClick={() => setShowQR(false)} className=\"flex-1 py-3 text-gray-500 font-bold hover:bg-gray-50 rounded-xl\">Close</button>\r\n                 <button onClick={() => window.print()} className=\"flex-1 bg-emerald-600 text-white py-3 rounded-xl font-bold shadow-lg hover:bg-emerald-700 flex items-center justify-center gap-2\">\r\n                    <Download size={18} /> Print / Save\r\n                 </button>\r\n              </div>\r\n           </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAJA;;;;;AAMe,SAAS,WAAW,EAAE,IAAI,EAAoB;IAC3D,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IAErC,MAAM,WAAW,CAAC,qBAAqB,EAAE,MAAM;IAE/C,MAAM,aAAa;QACjB,UAAU,SAAS,CAAC,SAAS,CAAC;QAC9B,UAAU;QACV,WAAW,IAAM,UAAU,QAAQ;IACrC;IAEA,MAAM,aAAa;QAChB,MAAM,MAAM,SAAS,cAAc,CAAC;QACpC,IAAI,KAAK;YACN,MAAM,UAAU,IAAI,gBAAgB,iBAAiB,CAAC;YACtD,MAAM,SAAS,SAAS,aAAa,CAAC;YACtC,MAAM,MAAM,OAAO,UAAU,CAAC;YAC9B,MAAM,MAAM,IAAI;YAChB,IAAI,MAAM,GAAG;gBACV,OAAO,KAAK,GAAG,IAAI,KAAK;gBACxB,OAAO,MAAM,GAAG,IAAI,MAAM;gBAC1B,KAAK,UAAU,KAAK,GAAG;gBACvB,MAAM,UAAU,OAAO,SAAS,CAAC;gBACjC,MAAM,eAAe,SAAS,aAAa,CAAC;gBAC5C,aAAa,QAAQ,GAAG,GAAG,KAAK,OAAO,CAAC;gBACxC,aAAa,IAAI,GAAG;gBACpB,aAAa,KAAK;YACrB;YACA,IAAI,GAAG,GAAG,+BAA+B,KAAK;QACjD;IACH;IAEA,qBACE;;0BACE,8OAAC;gBAAI,WAAU;;kCACZ,8OAAC;wBAAI,WAAU;;0CACZ,8OAAC;gCAAG,WAAU;;kDACX,8OAAC,oNAAM;wCAAC,MAAM;wCAAI,WAAU;;;;;;oCAAoB;;;;;;;0CAEnD,8OAAC;gCAAE,WAAU;0CAAgC;;;;;;0CAE7C,8OAAC;gCAAI,WAAU;;kDACX,8OAAC;wCACC,SAAS;wCACT,WAAU;;4CAER,uBAAS,8OAAC,6MAAK;gDAAC,MAAM;;;;;qEAAS,8OAAC,0MAAI;gDAAC,MAAM;;;;;;4CAC3C,SAAS,YAAY;;;;;;;kDAEzB,8OAAC;wCACE,SAAS,IAAM,UAAU;wCACzB,WAAU;;0DAEV,8OAAC,oNAAM;gDAAC,MAAM;;;;;;4CAAM;;;;;;;;;;;;;;;;;;;kCAK9B,8OAAC,oNAAM;wBAAC,MAAM;wBAAK,WAAU;;;;;;;;;;;;YAG/B,wBACC,8OAAC;gBAAI,WAAU;0BACZ,cAAA,8OAAC;oBAAI,WAAU;;sCACZ,8OAAC;4BACC,SAAS,IAAM,UAAU;4BACzB,WAAU;sCAET,cAAA,8OAAC,iMAAC;gCAAC,MAAM;;;;;;;;;;;sCAGZ,8OAAC;4BAAG,WAAU;sCAAuC;;;;;;sCACrD,8OAAC;4BAAE,WAAU;sCAA6B;;;;;;sCAE1C,8OAAC;4BAAI,WAAU;sCACZ,cAAA,8OAAC,mKAAS;gCACP,IAAG;gCACH,OAAO;gCACP,MAAM;gCACN,OAAO;gCACP,eAAe;;;;;;;;;;;sCAIrB,8OAAC;4BAAI,WAAU;;8CACZ,8OAAC;oCAAO,SAAS,IAAM,UAAU;oCAAQ,WAAU;8CAAkE;;;;;;8CACrH,8OAAC;oCAAO,SAAS,IAAM,OAAO,KAAK;oCAAI,WAAU;;sDAC9C,8OAAC,sNAAQ;4CAAC,MAAM;;;;;;wCAAM;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ1C"}},
    {"offset": {"line": 1270, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/components/dashboard/FlashDropModal.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { X, Zap, Clock, Loader2, CheckCircle2 } from \"lucide-react\";\r\n\r\ninterface FlashDropModalProps {\r\n  product: any;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n}\r\n\r\nexport default function FlashDropModal({ product, isOpen, onClose, onSuccess }: FlashDropModalProps) {\r\n  const [loading, setLoading] = useState(false);\r\n  const [dropPrice, setDropPrice] = useState(\"\");\r\n  const [duration, setDuration] = useState(\"1\"); // Default 1 hour\r\n  const [status, setStatus] = useState(\"\");\r\n\r\n  if (!isOpen || !product) return null;\r\n\r\n  const handleActivate = async () => {\r\n    if (!dropPrice || parseFloat(dropPrice) >= product.price) {\r\n      alert(\"Flash price must be lower than the original price!\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    const expiry = new Date();\r\n    expiry.setHours(expiry.getHours() + parseInt(duration));\r\n\r\n    const { error } = await supabase\r\n      .from(\"products\")\r\n      .update({\r\n        flash_drop_price: parseFloat(dropPrice),\r\n        flash_drop_expiry: expiry.toISOString(),\r\n      })\r\n      .eq(\"id\", product.id);\r\n\r\n    if (error) {\r\n      alert(\"Error: \" + error.message);\r\n    } else {\r\n      setStatus(\"success\");\r\n      setTimeout(() => {\r\n        onSuccess();\r\n        onClose();\r\n        setStatus(\"\");\r\n        setDropPrice(\"\");\r\n      }, 1500);\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  const deactivateDrop = async () => {\r\n    setLoading(true);\r\n    await supabase\r\n      .from(\"products\")\r\n      .update({ flash_drop_expiry: null, flash_drop_price: null })\r\n      .eq(\"id\", product.id);\r\n    \r\n    onSuccess();\r\n    onClose();\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in\">\r\n      <div className=\"bg-white w-full max-w-sm rounded-[2.5rem] p-8 shadow-2xl animate-in zoom-in-95 duration-200\">\r\n        \r\n        {status === \"success\" ? (\r\n          <div className=\"text-center py-6\">\r\n            <div className=\"w-20 h-20 bg-emerald-50 text-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n              <CheckCircle2 size={48} />\r\n            </div>\r\n            <h2 className=\"text-xl font-black text-gray-900 uppercase tracking-tight\">Flash Drop Live!</h2>\r\n            <p className=\"text-gray-500 text-sm mt-2\">The countdown has started.</p>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <div className=\"p-2 bg-amber-50 text-amber-500 rounded-xl\">\r\n                  <Zap size={20} fill=\"currentColor\" />\r\n                </div>\r\n                <h2 className=\"font-black text-lg text-gray-900 uppercase tracking-tight\">Flash Drop</h2>\r\n              </div>\r\n              <button onClick={onClose} className=\"p-2 hover:bg-gray-100 rounded-full transition\"><X size={20} /></button>\r\n            </div>\r\n\r\n            <div className=\"space-y-6\">\r\n              <div>\r\n                <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1\">Product</p>\r\n                <p className=\"font-bold text-gray-900 truncate\">{product.name}</p>\r\n                <p className=\"text-sm text-gray-500\">Original: ‚Ç¶{product.price.toLocaleString()}</p>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-xs font-black text-gray-700 uppercase tracking-widest mb-2 text-emerald-600\">Flash Sale Price (‚Ç¶)</label>\r\n                <input \r\n                  type=\"number\" \r\n                  autoFocus\r\n                  className=\"w-full p-4 bg-gray-50 border-2 border-emerald-100 rounded-2xl outline-none focus:ring-4 focus:ring-emerald-500/10 font-black text-xl text-emerald-600 transition-all\"\r\n                  placeholder=\"e.g. 15000\"\r\n                  value={dropPrice}\r\n                  onChange={(e) => setDropPrice(e.target.value)}\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-xs font-black text-gray-700 uppercase tracking-widest mb-2\">Duration</label>\r\n                <div className=\"grid grid-cols-4 gap-2\">\r\n                  {[\"1\", \"3\", \"6\", \"12\"].map((h) => (\r\n                    <button\r\n                      key={h}\r\n                      onClick={() => setDuration(h)}\r\n                      className={`py-3 rounded-xl text-xs font-bold border-2 transition-all ${\r\n                        duration === h \r\n                        ? 'border-gray-900 bg-gray-900 text-white shadow-lg' \r\n                        : 'border-gray-100 bg-white text-gray-500 hover:border-gray-200'\r\n                      }`}\r\n                    >\r\n                      {h}H\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"pt-2 flex flex-col gap-3\">\r\n                <button \r\n                  onClick={handleActivate}\r\n                  disabled={loading}\r\n                  className=\"w-full bg-gray-900 text-white py-4 rounded-2xl font-black text-sm uppercase tracking-[0.2em] shadow-xl hover:bg-black transition-all flex items-center justify-center gap-2\"\r\n                >\r\n                  {loading ? <Loader2 className=\"animate-spin\" /> : <><Zap size={18} fill=\"currentColor\" /> Start Drop Now</>}\r\n                </button>\r\n\r\n                {product.flash_drop_expiry && (\r\n                  <button \r\n                    onClick={deactivateDrop}\r\n                    className=\"w-full text-red-500 py-2 text-xs font-black uppercase tracking-widest hover:bg-red-50 rounded-xl transition\"\r\n                  >\r\n                    Cancel Current Drop\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1602, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/components/dashboard/DashboardClient.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useMemo } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { \r\n  Package, ExternalLink, \r\n  Crown, AlertTriangle, Eye, TrendingUp, Tags, Edit, Trash2,\r\n  Lock, Sparkles, X, BarChart3, Zap, Search, Plus // ‚úÖ Fixed: Added Plus\r\n} from \"lucide-react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport AddProductModal from \"@/components/store/AddProductModal\";\r\nimport CategoryManager from \"@/components/store/CategoryManager\";\r\nimport StoreSettings from \"@/components/dashboard/StoreSettings\";\r\nimport ShareStore from \"./ShareStore\";\r\nimport FlashDropModal from \"@/components/dashboard/FlashDropModal\";\r\n\r\ninterface DashboardClientProps {\r\n  store: any;\r\n  initialProducts: any[];\r\n  initialOrders: any[];\r\n  stats: { revenue: number; productCount: number; views: number };\r\n  isLocked: boolean; \r\n}\r\n\r\nexport default function DashboardClient({ store, initialProducts, initialOrders, stats, isLocked }: DashboardClientProps) {\r\n  const router = useRouter();\r\n  \r\n  // --- üõ°Ô∏è STATE MANAGEMENT ---\r\n  const [isAddModalOpen, setIsAddModalOpen] = useState(false);\r\n  const [isCatModalOpen, setIsCatModalOpen] = useState(false);\r\n  const [productToEdit, setProductToEdit] = useState<any>(null);\r\n  const [isAnalyticsOpen, setIsAnalyticsOpen] = useState(false);\r\n  const [selectedFlashProduct, setSelectedFlashProduct] = useState<any>(null);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n\r\n  // --- ‚ö° PERFORMANCE FILTERING ---\r\n  const filteredProducts = useMemo(() => {\r\n    return initialProducts.filter(p => \r\n      p.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      p.categories?.name?.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n  }, [searchTerm, initialProducts]);\r\n\r\n  const isFree = store.subscription_plan === 'free';\r\n  const isFreeLimitReached = isFree && stats.productCount >= 5;\r\n\r\n  // --- üõ†Ô∏è ACTIONS ---\r\n  const deleteProduct = async (id: string) => {\r\n    if (!confirm(\"Are you sure you want to delete this product?\")) return;\r\n    \r\n    // üî• FIX: Target \"products\" table, NOT \"storefront_products\" view\r\n    const { error } = await supabase.from(\"products\").delete().eq(\"id\", id);\r\n    \r\n    if (error) { \r\n      console.error(error); \r\n      alert(\"Could not delete product.\"); \r\n    } else { \r\n      router.refresh(); \r\n    }\r\n  };\r\n\r\n  const openEditModal = (product: any) => {\r\n    setProductToEdit(product);\r\n    setIsAddModalOpen(true);\r\n  };\r\n\r\n  const isRecentlySoldOut = (product: any) => {\r\n    if (!product.sold_out_at || product.stock_quantity > 0) return false;\r\n    const soldOutDate = new Date(product.sold_out_at);\r\n    const hoursDiff = (new Date().getTime() - soldOutDate.getTime()) / (1000 * 60 * 60);\r\n    return hoursDiff < 24;\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6 px-1 md:px-0 pb-20\">\r\n        {/* 1. HEADER (Your Original Style) */}\r\n        <header className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n          <div>\r\n            <h1 className=\"text-2xl md:text-3xl font-black text-gray-900 flex items-center gap-2 tracking-tight uppercase italic\">\r\n              Dashboard\r\n              {isLocked && <span className=\"bg-red-100 text-red-700 text-[10px] px-2 py-1 rounded-md border border-red-200\">OFFLINE</span>}\r\n            </h1>\r\n            <p className=\"text-gray-500 text-sm mt-1\">Welcome Back, <span className=\"font-bold text-gray-900\">{store.name}</span></p>\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 w-full md:w-auto\">\r\n            {!isLocked && (\r\n              <a href={`/${store.slug}`} target=\"_blank\" className=\"flex-1 md:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-xl text-sm font-bold hover:bg-gray-800 transition shadow-lg\">\r\n                <ExternalLink size={16} /> View Store\r\n              </a>\r\n            )}\r\n          </div>\r\n        </header>\r\n\r\n        {/* 2. QUICK STATS (Your Original Layout) */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <div className=\"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm\">\r\n             <div className=\"flex items-center gap-3 mb-2\">\r\n               <div className=\"p-2 bg-emerald-50 text-emerald-600 rounded-xl\"><TrendingUp size={20}/></div>\r\n               <span className=\"text-xs font-bold text-gray-400 uppercase tracking-wider\">Revenue</span>\r\n             </div>\r\n             <p className=\"text-2xl font-black text-gray-900\">‚Ç¶{stats.revenue.toLocaleString()}</p>\r\n          </div>\r\n\r\n          <div className=\"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm\">\r\n             <div className=\"flex items-center gap-3 mb-2\">\r\n               <div className=\"p-2 bg-blue-50 text-blue-600 rounded-xl\"><Package size={20}/></div>\r\n               <span className=\"text-xs font-bold text-gray-400 uppercase tracking-wider\">Products</span>\r\n             </div>\r\n             <p className=\"text-2xl font-black text-gray-900\">{stats.productCount}</p>\r\n          </div>\r\n\r\n          <div className=\"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm\">\r\n             <div className=\"flex items-center gap-3 mb-2\">\r\n               <div className=\"p-2 bg-purple-50 text-purple-600 rounded-xl\"><Eye size={20}/></div>\r\n               <span className=\"text-xs font-bold text-gray-400 uppercase tracking-wider\">Views</span>\r\n             </div>\r\n             <p className=\"text-2xl font-black text-gray-900\">{stats.views.toLocaleString()}</p>\r\n          </div>\r\n        </div>\r\n\r\n        <ShareStore slug={store.slug} />\r\n\r\n        {/* 3. üî• PRODUCT SECTION (Removed Orders/Settings tabs as requested) */}\r\n        <div className=\"animate-in fade-in slide-in-from-bottom-4 duration-500\">\r\n          \r\n          <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6\">\r\n            <h3 className=\"font-bold text-lg text-gray-900\">Inventory</h3>\r\n            <div className=\"flex gap-2 w-full md:w-auto\">\r\n               <button onClick={() => setIsCatModalOpen(true)} className=\"flex-1 md:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-white border border-gray-200 text-gray-700 rounded-xl text-sm font-bold hover:bg-gray-50 transition\">\r\n                  <Tags size={16}/> <span className=\"md:inline\">Categories</span>\r\n               </button>\r\n               <button onClick={() => setIsAddModalOpen(true)} className=\"flex-1 md:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-xl text-sm font-bold shadow-lg hover:bg-emerald-500 transition\">\r\n                  <Plus size={16}/> <span className=\"md:inline\">Add Product</span>\r\n               </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* üîç SEARCH BAR (Integrated perfectly into your design) */}\r\n          <div className=\"relative mb-6 group\">\r\n            <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-gray-900 transition-colors\" size={18} />\r\n            <input \r\n              type=\"text\"\r\n              placeholder=\"Search products...\"\r\n              className=\"w-full pl-12 pr-4 py-3.5 bg-white border border-gray-200 rounded-2xl text-sm font-bold outline-none focus:ring-2 focus:ring-gray-900 transition-all shadow-sm\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n            />\r\n            {searchTerm && (\r\n              <button onClick={() => setSearchTerm(\"\")} className=\"absolute right-4 top-1/2 -translate-y-1/2 p-1 bg-gray-100 rounded-full hover:bg-gray-200\">\r\n                <X size={14} />\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"mb-4 px-1 flex justify-between items-center\">\r\n             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">\r\n               {filteredProducts.length} items found\r\n             </p>\r\n             {/* ‚úÖ FIXED: Red line error resolved here */}\r\n             {filteredProducts.some(p => isRecentlySoldOut(p)) && (\r\n               <span className=\"text-[9px] font-bold text-amber-600 italic\">Stock visibility active</span>\r\n             )}\r\n          </div>\r\n\r\n          {/* INVENTORY TABLE (Reverted to your original styling) */}\r\n          <div className=\"bg-white border border-gray-100 rounded-3xl overflow-hidden shadow-sm overflow-x-auto\">\r\n             {filteredProducts.length === 0 ? (\r\n               <div className=\"p-12 text-center text-gray-400\">\r\n                 <Package size={48} className=\"mx-auto mb-4 opacity-20\"/>\r\n                 <p>{searchTerm ? \"No products match your search.\" : \"No products yet.\"}</p>\r\n               </div>\r\n             ) : (\r\n               <table className=\"w-full text-left min-w-[600px]\">\r\n                 <thead className=\"bg-gray-50/50 border-b border-gray-100 text-[10px] uppercase text-gray-500\">\r\n                   <tr>\r\n                     <th className=\"px-6 py-4 font-bold\">Product</th>\r\n                     <th className=\"px-6 py-4 font-bold\">Category</th>\r\n                     <th className=\"px-6 py-4 font-bold\">Price</th>\r\n                     <th className=\"px-6 py-4 font-bold\">Stock</th>\r\n                     <th className=\"px-6 py-4 font-bold text-right\">Actions</th>\r\n                   </tr>\r\n                 </thead>\r\n                 <tbody className=\"divide-y divide-gray-100\">\r\n                   {filteredProducts.map((p) => {\r\n                     const soldOut = isRecentlySoldOut(p);\r\n                     return (\r\n                      <tr key={p.id} className=\"hover:bg-gray-50/80 transition\">\r\n                        <td className=\"px-6 py-4 font-bold text-gray-900 text-sm md:text-base\">\r\n                          {p.name}\r\n                          {soldOut && <span className=\"block text-[8px] text-amber-600 font-black uppercase\">Recent Sale</span>}\r\n                        </td>\r\n                        <td className=\"px-6 py-4 text-gray-500 text-xs md:text-sm\">\r\n                          <span className=\"px-2 py-1 bg-gray-100 rounded-lg font-bold\">{p.categories?.name || 'General'}</span>\r\n                        </td>\r\n                        <td className=\"px-6 py-4 text-emerald-600 font-bold text-xs md:text-sm\">‚Ç¶{p.price.toLocaleString()}</td>\r\n                        <td className=\"px-6 py-4 text-xs md:text-sm\">\r\n                          {p.stock_quantity === 0 \r\n                            ? <span className=\"text-red-500 font-bold bg-red-50 px-2 py-1 rounded-lg\">Sold Out</span> \r\n                            : <span className=\"text-gray-600 font-bold\">{p.stock_quantity}</span>\r\n                          }\r\n                        </td>\r\n                        <td className=\"px-6 py-4 text-right flex justify-end gap-1 md:gap-2\">\r\n                           <button onClick={() => setSelectedFlashProduct(p)} className={`p-2 rounded-lg transition-all ${p.flash_drop_expiry && new Date(p.flash_drop_expiry) > new Date() ? 'text-amber-500 bg-amber-50' : 'text-gray-300 hover:text-amber-500'}`}>\r\n                             <Zap size={18} fill={p.flash_drop_expiry && new Date(p.flash_drop_expiry) > new Date() ? \"currentColor\" : \"none\"} />\r\n                           </button>\r\n                           <button onClick={() => openEditModal(p)} className=\"p-2 text-gray-400 hover:text-blue-600 transition\"><Edit size={16}/></button>\r\n                           <button onClick={() => deleteProduct(p.id)} className=\"p-2 text-gray-400 hover:text-red-600 transition\"><Trash2 size={16}/></button>\r\n                        </td>\r\n                      </tr>\r\n                     );\r\n                   })}\r\n                 </tbody>\r\n               </table>\r\n             )}\r\n          </div>\r\n        </div>\r\n\r\n      {/* MODALS */}\r\n      <AddProductModal storeId={store.id} isOpen={isAddModalOpen} onClose={() => { setIsAddModalOpen(false); setProductToEdit(null); }} onSuccess={() => router.refresh()} productToEdit={productToEdit} />\r\n      <CategoryManager storeId={store.id} isOpen={isCatModalOpen} onClose={() => setIsCatModalOpen(false)} onSuccess={() => router.refresh()} />\r\n      <FlashDropModal product={selectedFlashProduct} isOpen={!!selectedFlashProduct} onClose={() => setSelectedFlashProduct(null)} onSuccess={() => router.refresh()} />\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2357, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/app/dashboard/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState, useCallback } from \"react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport DashboardClient from \"@/components/dashboard/DashboardClient\";\r\nimport { Loader2 } from \"lucide-react\";\r\n\r\nexport default function DashboardPage() {\r\n  const router = useRouter();\r\n  const [loading, setLoading] = useState(true);\r\n  \r\n  const [store, setStore] = useState<any>(null);\r\n  const [products, setProducts] = useState<any[]>([]);\r\n  const [orders, setOrders] = useState<any[]>([]);\r\n  const [stats, setStats] = useState({ revenue: 0, productCount: 0, views: 0 });\r\n  const [isLocked, setIsLocked] = useState(false); \r\n\r\n  const loadDashboardData = useCallback(async () => {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      \r\n      if (!user) {\r\n        router.push(\"/login\");\r\n        return;\r\n      }\r\n\r\n      const { data: storeData } = await supabase\r\n        .from(\"stores\")\r\n        .select(\"*\")\r\n        .eq(\"owner_id\", user.id) \r\n        .single();\r\n\r\n      if (!storeData) {\r\n        router.push(\"/onboarding\");\r\n        return;\r\n      }\r\n\r\n      setStore(storeData);\r\n\r\n      if (storeData.subscription_expiry) {\r\n        const expiry = new Date(storeData.subscription_expiry);\r\n        const now = new Date();\r\n        setIsLocked(expiry < now);\r\n      }\r\n\r\n      const { data: productsData } = await supabase\r\n        .from(\"products\")\r\n        .select(\"*, categories(name)\")\r\n        .eq(\"store_id\", storeData.id)\r\n        .order(\"created_at\", { ascending: false });\r\n      \r\n      setProducts(productsData || []);\r\n\r\n      const { data: ordersData } = await supabase\r\n        .from(\"orders\")\r\n        .select(\"*\")\r\n        .eq(\"store_id\", storeData.id)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n      setOrders(ordersData || []);\r\n\r\n      const revenue = ordersData?.reduce((acc, order) => {\r\n            return acc + (['completed', 'paid'].includes(order.status) ? order.total_amount : 0);\r\n      }, 0) || 0;\r\n\r\n      const count = productsData?.length || 0;\r\n      \r\n      // Set Stats\r\n      setStats({ \r\n        revenue, \r\n        productCount: count, \r\n        views: storeData.view_count || 0 \r\n      });\r\n\r\n    } catch (error) {\r\n      console.error(\"Dashboard Load Error:\", error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [router]);\r\n\r\n  useEffect(() => {\r\n    loadDashboardData();\r\n\r\n    const channel = supabase\r\n      .channel('dashboard-updates')\r\n      .on(\r\n        'postgres_changes',\r\n        { event: '*', schema: 'public', table: 'orders' },\r\n        (payload) => {\r\n          console.log('Order update!', payload);\r\n          loadDashboardData(); \r\n        }\r\n      )\r\n      .on(\r\n        'postgres_changes',\r\n        { event: '*', schema: 'public', table: 'stores' },\r\n        (payload) => {\r\n          console.log('View count update!', payload);\r\n          loadDashboardData();\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n    };\r\n\r\n  }, [loadDashboardData]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\r\n        <Loader2 className=\"w-8 h-8 animate-spin text-gray-400\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!store) return null;\r\n\r\n  return (\r\n    <DashboardClient \r\n      store={store} \r\n      initialProducts={products} \r\n      initialOrders={orders}\r\n      stats={stats}\r\n      isLocked={isLocked} \r\n    />\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}