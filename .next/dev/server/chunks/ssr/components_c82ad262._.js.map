{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/components/StoreFront.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport Image from \"next/image\";\r\nimport Link from \"next/link\";\r\nimport { \r\n  MapPin, Info, Copy, Check, ShoppingBag, \r\n  X, Instagram, Search, Package, Phone, LayoutDashboard, ChevronRight,\r\n  BadgeCheck, Gem, Share2, Plus, Zap, Loader2\r\n} from \"lucide-react\";\r\nimport { Store } from \"@/types\";\r\nimport { useCart } from \"@/context/CartContext\";\r\n\r\nconst TiktokIcon = ({ size = 20 }: { size?: number }) => (\r\n  <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M9 12a4 4 0 1 0 4 4V4a5 5 0 0 0 5 5\"/></svg>\r\n);\r\n\r\nconst VerificationBadge = ({ store }: { store: any }) => {\r\n  return (\r\n    <div className=\"inline-flex items-center gap-1 ml-1 align-middle\">\r\n      {store.verification_status === 'verified' && <BadgeCheck size={16} className=\"text-blue-500 fill-blue-50\" />}\r\n      {store.subscription_plan === 'diamond' && <Gem size={16} className=\"text-purple-600 fill-purple-50\" />}\r\n    </div>\r\n  );\r\n};\r\n\r\ninterface StoreFrontProps {\r\n  store: Store;\r\n  products: any[];\r\n  categories: { id: string; name: string }[];\r\n}\r\n\r\nexport default function StoreFront({ store, products: initialProducts, categories }: StoreFrontProps) {\r\n  const { addToCart, cartCount, setIsCartOpen, isCartOpen } = useCart();\r\n  \r\n  // --- CORE STATES ---\r\n  const [products, setProducts] = useState(initialProducts);\r\n  const [activeCategory, setActiveCategory] = useState(\"All\");\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [debouncedSearch, setDebouncedSearch] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [isInfoOpen, setIsInfoOpen] = useState(false);\r\n  const [copied, setCopied] = useState(false);\r\n  const [visibleCount, setVisibleCount] = useState(20);\r\n  const [isJumping, setIsJumping] = useState(false);\r\n\r\n  // --- NEW: SCROLL DIRECTION LOGIC ---\r\n  const [isVisible, setIsVisible] = useState(true);\r\n  const [lastScrollY, setLastScrollY] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const handleScroll = () => {\r\n      const currentScrollY = window.scrollY;\r\n      if (currentScrollY > lastScrollY && currentScrollY > 100) {\r\n        setIsVisible(false);\r\n      } else {\r\n        setIsVisible(true);\r\n      }\r\n      setLastScrollY(currentScrollY);\r\n    };\r\n    window.addEventListener(\"scroll\", handleScroll, { passive: true });\r\n    return () => window.removeEventListener(\"scroll\", handleScroll);\r\n  }, [lastScrollY]);\r\n\r\n  // --- ✨ SEARCH DEBOUNCE LOGIC ---\r\n  useEffect(() => {\r\n    const handler = setTimeout(() => {\r\n      setDebouncedSearch(searchTerm);\r\n    }, 500);\r\n    return () => clearTimeout(handler);\r\n  }, [searchTerm]);\r\n\r\n  // --- ✨ GLOBAL SERVER-SIDE FILTERING ---\r\n  useEffect(() => {\r\n    const fetchStoreProducts = async () => {\r\n      // If no search/category, reset to initial\r\n      if (activeCategory === \"All\" && !debouncedSearch) {\r\n        setProducts(initialProducts);\r\n        return;\r\n      }\r\n\r\n      setLoading(true);\r\n      let query = supabase\r\n        .from(\"storefront_products\")\r\n        .select(\"*\")\r\n        .eq(\"store_id\", store.id)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n      if (activeCategory !== \"All\") {\r\n        query = query.eq(\"categories.name\", activeCategory);\r\n      }\r\n\r\n      if (debouncedSearch) {\r\n        query = query.ilike(\"name\", `%${debouncedSearch}%`);\r\n      }\r\n\r\n      const { data } = await query;\r\n      setProducts(data || []);\r\n      setLoading(false);\r\n    };\r\n\r\n    fetchStoreProducts();\r\n  }, [activeCategory, debouncedSearch, store.id, initialProducts]);\r\n\r\n  const handleCopyLink = () => {\r\n    navigator.clipboard.writeText(`${window.location.origin}/${store.slug}`);\r\n    setCopied(true);\r\n    setTimeout(() => setCopied(false), 2000);\r\n  };\r\n\r\n  const handleAddToCart = (product: any) => {\r\n    const isFlashActive = product.flash_drop_expiry && new Date(product.flash_drop_expiry) > new Date();\r\n    \r\n    if (isFlashActive) {\r\n      const audio = new Audio('/sounds/empire-drop.mp3');\r\n      audio.volume = 0.5;\r\n      audio.play().catch(err => console.log(\"Audio play blocked\"));\r\n    }\r\n    \r\n    setIsJumping(true);\r\n    setTimeout(() => setIsJumping(false), 600);\r\n    addToCart(product, store);\r\n  };\r\n\r\n  const displayedProducts = products.slice(0, visibleCount);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-white font-sans flex flex-col selection:bg-emerald-100\">\r\n      \r\n      {/* HEADER NAVIGATION */}\r\n      <nav className=\"sticky top-0 z-40 bg-white/80 backdrop-blur-xl border-b border-gray-100 h-16 flex items-center justify-between px-4 md:px-8 shadow-sm\">\r\n          <div className=\"flex items-center gap-3\">\r\n             <Link href=\"/\" className=\"flex items-center gap-1\">\r\n                <LayoutDashboard size={18} className=\"text-emerald-600\"/> \r\n                <span className=\"font-black text-gray-900 tracking-tighter hidden md:block uppercase text-[10px]\">StoreLink</span>\r\n             </Link>\r\n             <span className=\"text-gray-200 font-thin text-xl\">/</span>\r\n             <div className=\"flex items-center gap-2\">\r\n                <h1 className=\"font-bold text-gray-900 truncate max-w-[160px] md:max-w-none flex items-center text-sm md:text-base tracking-tight\">\r\n                  {store.name} <VerificationBadge store={store} />\r\n                </h1>\r\n             </div>\r\n          </div>\r\n          <button onClick={() => setIsInfoOpen(true)} className=\"p-2 hover:bg-gray-100 rounded-full transition text-gray-600 active:scale-90\">\r\n             <Info size={20} />\r\n          </button>\r\n      </nav>\r\n\r\n      {/* HERO SECTION */}\r\n      <div className=\"relative w-full bg-gray-50 border-b border-gray-100\">\r\n          <div className=\"w-full h-40 md:h-64 relative overflow-hidden bg-gray-200\">\r\n             {store.cover_image_url ? (\r\n                <Image src={store.cover_image_url} alt=\"\" fill className=\"object-cover\" priority />\r\n             ) : (\r\n                <div className=\"absolute inset-0 flex items-center justify-center text-gray-300 bg-gray-100\"><Package size={48} className=\"opacity-20\" /></div>\r\n             )}\r\n             <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent\"></div>\r\n          </div>\r\n\r\n          <div className=\"max-w-7xl mx-auto px-4 md:px-8 -mt-10 md:-mt-14 relative z-10 pb-6\">\r\n             <div className=\"flex flex-col md:flex-row items-start md:items-end justify-between gap-4\">\r\n                <div className=\"flex items-end gap-3 md:gap-5\">\r\n                   <div className=\"w-24 h-24 md:w-36 md:h-36 rounded-3xl border-[4px] border-white shadow-xl bg-white relative overflow-hidden shrink-0\">\r\n                      {store.logo_url ? (\r\n                         <Image src={store.logo_url} alt=\"Logo\" fill className=\"object-cover\" />\r\n                      ) : (\r\n                         <div className=\"flex items-center justify-center h-full text-2xl font-bold bg-gray-900 text-white\">{store.name.charAt(0)}</div>\r\n                      )}\r\n                   </div>\r\n                   <div className=\"hidden md:block mb-4\">\r\n                      <h2 className=\"text-2xl font-black text-gray-900 flex items-center gap-2 uppercase tracking-tight\">\r\n                        {store.name} <VerificationBadge store={store} />\r\n                      </h2>\r\n                      <p className=\"text-gray-500 text-xs font-bold flex items-center gap-1\"><MapPin size={14} className=\"text-emerald-500\"/> {store.location}</p>\r\n                   </div>\r\n                </div>\r\n\r\n                <div className=\"flex gap-2 w-full md:w-auto mt-2 md:mt-0\">\r\n                   <button onClick={handleCopyLink} className=\"flex-1 md:flex-none py-2.5 px-5 bg-white border border-gray-200 shadow-sm rounded-xl text-xs font-black text-gray-700 active:scale-95 transition\">\r\n                      {copied ? \"COPIED\" : \"SHARE STORE\"}\r\n                   </button>\r\n                   <button onClick={() => setIsInfoOpen(true)} className=\"flex-1 md:flex-none py-2.5 px-5 bg-gray-900 shadow-lg rounded-xl text-xs font-black text-white active:scale-95 transition uppercase tracking-wider\">\r\n                      More Info\r\n                   </button>\r\n                </div>\r\n             </div>\r\n\r\n             <div className=\"mt-3 md:hidden\">\r\n                <h2 className=\"text-xl font-black text-gray-900 flex items-center gap-1 uppercase tracking-tight\">\r\n                  {store.name} <VerificationBadge store={store} />\r\n                </h2>\r\n                <p className=\"text-gray-500 text-xs font-bold mt-0.5\">{store.location}</p>\r\n             </div>\r\n          </div>\r\n      </div>\r\n\r\n      {/* STICKY SEARCH/FILTER BAR: HIDE ON SCROLL LOGIC */}\r\n      <div className={`sticky top-16 z-30 bg-white/95 backdrop-blur-md border-b border-gray-100 shadow-sm transition-all duration-300 ease-in-out ${\r\n          isVisible \r\n          ? \"translate-y-0 opacity-100\" \r\n          : \"-translate-y-24 opacity-0 pointer-events-none md:translate-y-0 md:opacity-100 md:pointer-events-auto\"\r\n      }`}>\r\n          <div className=\"max-w-7xl mx-auto px-4 md:px-8 py-3\">\r\n             <div className=\"flex flex-col md:flex-row gap-3\">\r\n                <div className=\"relative w-full md:max-w-xs\">\r\n                   <Search className=\"absolute left-3.5 top-2.5 text-gray-400\" size={16} />\r\n                   <input \r\n                     className=\"w-full pl-10 pr-4 py-2 bg-gray-100 rounded-xl text-sm outline-none focus:bg-white transition font-medium\"\r\n                     placeholder=\"Search store...\"\r\n                     value={searchTerm}\r\n                     onChange={e => setSearchTerm(e.target.value)}\r\n                   />\r\n                </div>\r\n                \r\n                <div className=\"flex gap-2 overflow-x-auto no-scrollbar items-center pb-1\">\r\n                   <button \r\n                     onClick={() => setActiveCategory(\"All\")}\r\n                     className={`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest whitespace-nowrap transition ${activeCategory === \"All\" ? \"bg-black text-white\" : \"bg-white text-gray-500 border border-gray-200\"}`}\r\n                   >\r\n                     All\r\n                   </button>\r\n                   {categories.map(cat => (\r\n                     <button \r\n                       key={cat.id}\r\n                       onClick={() => setActiveCategory(cat.name)}\r\n                       className={`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest whitespace-nowrap transition ${activeCategory === cat.name ? \"bg-black text-white\" : \"bg-white text-gray-500 border border-gray-200\"}`}\r\n                     >\r\n                       {cat.name}\r\n                     </button>\r\n                   ))}\r\n                </div>\r\n             </div>\r\n          </div>\r\n      </div>\r\n\r\n      {/* PRODUCT GRID */}\r\n      <div className=\"flex-1 bg-white\">\r\n          <div className=\"max-w-7xl mx-auto px-4 md:px-8 py-6\">\r\n             {loading ? (\r\n                <div className=\"flex justify-center py-20\"><Loader2 className=\"animate-spin text-emerald-600\" size={32} /></div>\r\n             ) : (\r\n             <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-6\">\r\n                {displayedProducts.map(product => {\r\n                  const isFlashActive = product.flash_drop_expiry && new Date(product.flash_drop_expiry) > new Date();\r\n                  \r\n                  return (\r\n                    <div key={product.id} className=\"group bg-white rounded-2xl overflow-hidden border border-gray-100 flex flex-col relative transition-all duration-300 active:scale-[0.98] md:hover:shadow-xl md:hover:-translate-y-1\">\r\n                       <Link href={`/product/${product.id}`} className=\"block relative aspect-square bg-gray-50 overflow-hidden\">\r\n                          {product.image_urls?.[0] ? (\r\n                            <Image \r\n                              src={product.image_urls[0]} \r\n                              alt={product.name} \r\n                              fill \r\n                              className=\"object-cover\" \r\n                            />\r\n                          ) : (\r\n                            <div className=\"flex items-center justify-center h-full text-gray-200\"><Package size={32}/></div>\r\n                          )}\r\n\r\n                          {isFlashActive && (\r\n                            <div className=\"absolute top-2 left-2 bg-amber-500 text-white px-2 py-1 rounded-lg shadow-lg flex items-center gap-1 z-10 animate-pulse\">\r\n                               <Zap size={10} fill=\"currentColor\" />\r\n                               <span className=\"text-[8px] font-black uppercase tracking-tighter\">Live Drop</span>\r\n                            </div>\r\n                          )}\r\n                          \r\n                          {product.stock_quantity === 0 && (\r\n                             <div className=\"absolute inset-0 bg-white/60 backdrop-blur-[1px] flex items-center justify-center\">\r\n                                <span className=\"text-[10px] font-black uppercase tracking-widest text-red-600\">Sold Out</span>\r\n                             </div>\r\n                          )}\r\n                       </Link>\r\n\r\n                       <div className=\"p-3 md:p-4 flex flex-col flex-1\">\r\n                          <h3 className=\"font-bold text-gray-900 leading-tight line-clamp-1 text-xs md:text-sm mb-1 uppercase tracking-tight\">{product.name}</h3>\r\n                          \r\n                          <div className=\"flex items-center justify-between mt-auto\">\r\n                             {isFlashActive ? (\r\n                              <div className=\"flex flex-col\">\r\n                                 <p className=\"text-[10px] font-bold text-gray-300 line-through tracking-tighter decoration-red-500/30\">₦{product.price.toLocaleString()}</p>\r\n                                 <div className=\"flex items-center gap-2\">\r\n                                    <p className=\"text-sm md:text-base font-black text-emerald-600 tracking-tighter\">₦{product.flash_drop_price.toLocaleString()}</p>\r\n                                    {store.loyalty_enabled && (\r\n                                    <span className=\"text-[9px] font-black text-amber-500 bg-amber-50 px-1.5 py-0.5 rounded-md flex items-center gap-1 animate-in zoom-in\">\r\n                                       <Zap size={8} fill=\"currentColor\"/> +₦{(product.flash_drop_price * ((store.loyalty_percentage || 1) / 100)).toLocaleString()}\r\n                                    </span>\r\n                                    )}\r\n                                 </div>\r\n                              </div>\r\n                              ) : (\r\n                              <div className=\"flex flex-col\">\r\n                                 <div className=\"flex items-center gap-2\">\r\n                                    <p className=\"text-sm md:text-base font-black text-emerald-600 tracking-tighter\">₦{product.price.toLocaleString()}</p>\r\n                                    {store.loyalty_enabled && (\r\n                                    <span className=\"text-[9px] font-black text-amber-500 bg-amber-50 px-1.5 py-0.5 rounded-md animate-in zoom-in\">\r\n                                       +₦{(product.price * ((store.loyalty_percentage || 1) / 100)).toLocaleString()}\r\n                                    </span>\r\n                                    )}\r\n                                 </div>\r\n                              </div>\r\n                              )}\r\n                             \r\n                             <button \r\n                               disabled={product.stock_quantity === 0}\r\n                               onClick={() => handleAddToCart(product)}\r\n                               className={`p-2 rounded-lg shadow-md transition-colors disabled:bg-gray-100 disabled:text-gray-300 ${isFlashActive ? 'bg-amber-500 text-white' : 'bg-gray-900 text-white active:bg-emerald-600'}`}\r\n                             >\r\n                                <Plus size={16} />\r\n                             </button>\r\n                          </div>\r\n                       </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n             </div>\r\n             )}\r\n\r\n             {visibleCount < products.length && (\r\n               <div className=\"mt-12 text-center pb-10\">\r\n                 <button \r\n                   onClick={() => setVisibleCount(prev => prev + 20)}\r\n                   className=\"px-10 py-4 bg-white border-2 border-gray-900 text-gray-900 rounded-2xl font-black text-xs uppercase tracking-[0.2em] hover:bg-gray-900 hover:text-white transition-all active:scale-95 shadow-lg\"\r\n                 >\r\n                   Load More Products\r\n                 </button>\r\n               </div>\r\n             )}\r\n\r\n             {!loading && products.length === 0 && (\r\n                <div className=\"text-center py-20 flex flex-col items-center\">\r\n                   <Package size={40} className=\"text-gray-100 mb-2\"/>\r\n                   <p className=\"text-gray-400 font-bold uppercase text-[10px] tracking-widest\">No products found</p>\r\n                </div>\r\n             )}\r\n          </div>\r\n      </div>\r\n\r\n      {/* FOOTER */}\r\n      <footer className=\"bg-gray-50 border-t border-gray-200 py-10 text-center mt-auto\">\r\n          <p className=\"text-[9px] text-gray-400 font-black uppercase tracking-[0.3em]\">StoreLink social engine • 2025</p>\r\n      </footer>\r\n\r\n      {/* CART BUTTON */}\r\n      {cartCount > 0 && !isCartOpen && (\r\n        <button \r\n          onClick={() => setIsCartOpen(true)} \r\n          className={`fixed bottom-6 right-6 bg-gray-900 text-white p-4 rounded-2xl shadow-2xl z-50 transition-all active:scale-90 ${isJumping ? 'animate-bounce' : 'hover:scale-110 animate-in zoom-in'}`}\r\n        >\r\n           <ShoppingBag size={24} />\r\n           <span className=\"absolute -top-1 -right-1 bg-emerald-500 w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-black border-2 border-white\">\r\n             {cartCount}\r\n           </span>\r\n        </button>\r\n      )}\r\n\r\n      {/* INFO SIDEBAR */}\r\n      {isInfoOpen && (\r\n          <div className=\"fixed inset-0 z-[60] bg-black/60 backdrop-blur-sm flex justify-end animate-in fade-in\">\r\n             <div className=\"absolute inset-0\" onClick={() => setIsInfoOpen(false)}></div>\r\n             <div className=\"relative w-full max-w-sm bg-white h-full shadow-2xl p-8 overflow-y-auto animate-in slide-in-from-right duration-300 flex flex-col rounded-l-[2rem]\">\r\n                <div className=\"flex justify-between items-center mb-8\">\r\n                   <h2 className=\"font-black text-gray-900 uppercase tracking-tighter text-sm\">About Business</h2>\r\n                   <button onClick={() => setIsInfoOpen(false)} className=\"p-2 bg-gray-100 rounded-full\"><X size={20}/></button>\r\n                </div>\r\n\r\n                <div className=\"text-center mb-8\">\r\n                   <div className=\"w-24 h-24 bg-gray-100 rounded-2xl mx-auto mb-4 overflow-hidden border-2 border-gray-100 relative\">\r\n                       {store.logo_url ? <Image src={store.logo_url} alt=\"\" fill className=\"object-cover\" /> : null}\r\n                   </div>\r\n                   <h3 className=\"font-black text-2xl text-gray-900 tracking-tighter uppercase flex items-center justify-center gap-1\">\r\n                     {store.name} <VerificationBadge store={store} />\r\n                   </h3>\r\n                   <p className=\"text-gray-400 text-[10px] font-black uppercase mt-1 tracking-widest\">{store.location}</p>\r\n                </div>\r\n\r\n                <div className=\"bg-gray-50 p-6 rounded-2xl mb-8 border border-gray-100\">\r\n                   <p className=\"text-gray-600 text-sm italic text-center font-medium\">\r\n                     \"{store.description || 'Welcome to our store! We sell amazing products.'}\"\r\n                   </p>\r\n                </div>\r\n\r\n                <div className=\"space-y-3 mt-auto\">\r\n                    <h4 className=\"font-black text-gray-400 text-[10px] uppercase tracking-widest mb-2\">Connect</h4>\r\n                    {store.whatsapp_number && (\r\n                        <div className=\"flex items-center gap-4 p-4 rounded-xl border border-gray-100\">\r\n                            <div className=\"bg-emerald-500 p-2 rounded-lg text-white\"><Phone size={18}/></div>\r\n                            <div>\r\n                                <p className=\"text-[9px] text-emerald-600 font-black uppercase tracking-widest\">WhatsApp</p>\r\n                                <p className=\"text-sm font-bold text-gray-900\">{store.whatsapp_number}</p>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    {store.instagram_handle && (\r\n                        <a href={`https://instagram.com/${store.instagram_handle}`} target=\"_blank\" className=\"flex items-center justify-between p-4 bg-gray-50 rounded-xl font-bold\">\r\n                            <span className=\"flex items-center gap-3 text-xs uppercase tracking-widest\"><Instagram size={18} /> Instagram</span>\r\n                            <ChevronRight size={14}/>\r\n                        </a>\r\n                    )}\r\n                </div>\r\n                <p className=\"text-center text-[9px] font-black text-gray-300 mt-8\">Store ID: {store.slug}</p>\r\n             </div>\r\n          </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1144, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/components/ViewTracker.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef } from \"react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\n\r\nexport default function ViewTracker({ storeId }: { storeId: string }) {\r\n  const hasCounted = useRef(false);\r\n\r\n  useEffect(() => {\r\n    const sessionKey = `viewed_store_${storeId}`;\r\n    if (sessionStorage.getItem(sessionKey) || hasCounted.current) {\r\n      return; \r\n    }\r\n\r\n    const countView = async () => {\r\n      try {\r\n        hasCounted.current = true;\r\n        sessionStorage.setItem(sessionKey, \"true\");\r\n\r\n        await supabase.rpc('increment_store_view', { store_uuid: storeId });\r\n      } catch (error) {\r\n        console.error(error); \r\n      }\r\n    };\r\n\r\n    countView();\r\n  }, [storeId]);\r\n\r\n  return null; \r\n}"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAKe,SAAS,YAAY,EAAE,OAAO,EAAuB;IAClE,MAAM,aAAa,IAAA,+MAAM,EAAC;IAE1B,IAAA,kNAAS,EAAC;QACR,MAAM,aAAa,CAAC,aAAa,EAAE,SAAS;QAC5C,IAAI,eAAe,OAAO,CAAC,eAAe,WAAW,OAAO,EAAE;YAC5D;QACF;QAEA,MAAM,YAAY;YAChB,IAAI;gBACF,WAAW,OAAO,GAAG;gBACrB,eAAe,OAAO,CAAC,YAAY;gBAEnC,MAAM,2HAAQ,CAAC,GAAG,CAAC,wBAAwB;oBAAE,YAAY;gBAAQ;YACnE,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC;YAChB;QACF;QAEA;IACF,GAAG;QAAC;KAAQ;IAEZ,OAAO;AACT"}}]
}