{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/context/CartContext.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { createContext, useContext, useState, useEffect, ReactNode } from \"react\";\r\nimport { Product, Store } from \"@/types\";\r\n\r\nexport type CartItem = { \r\n  product: Product; \r\n  store: Store; \r\n  qty: number \r\n};\r\n\r\ninterface CartContextType {\r\n  cart: CartItem[];\r\n  cartCount: number;\r\n  cartTotal: number; // Raw subtotal\r\n  finalTotal: number; // Final price customer pays\r\n  addToCart: (product: Product, store: Store) => void;\r\n  removeFromCart: (productId: string) => void;\r\n  updateQuantity: (productId: string, quantity: number) => void;\r\n  clearCart: () => void;\r\n  isCartOpen: boolean;\r\n  setIsCartOpen: (isOpen: boolean) => void;\r\n  openCart: () => void;\r\n  closeCart: () => void;\r\n  // âœ¨ EMPIRE ECONOMY PROPERTIES\r\n  useCoins: boolean;\r\n  setUseCoins: (use: boolean) => void;\r\n  redeemableCoins: number; // Actual amount being deducted (Max 15%)\r\n  actualBalance: number;   // Full user bank balance\r\n}\r\n\r\nconst CartContext = createContext<CartContextType | undefined>(undefined);\r\n\r\nexport function CartProvider({ children }: { children: ReactNode }) {\r\n  const [cart, setCart] = useState<CartItem[]>([]);\r\n  const [isCartOpen, setIsCartOpen] = useState(false);\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n  \r\n  // âœ¨ EMPIRE STATES\r\n  const [useCoins, setUseCoins] = useState(false);\r\n  const [userCoinBalance, setUserCoinBalance] = useState(0);\r\n\r\n  // 1. âœ¨ INITIAL LOAD & BALANCE SYNC\r\n  useEffect(() => {\r\n    const savedCart = localStorage.getItem(\"storelink_cart\");\r\n    \r\n    if (savedCart) {\r\n      try { setCart(JSON.parse(savedCart)); } catch (e) { console.error(e); }\r\n    }\r\n    \r\n    // Initial balance check from storage\r\n    const savedBalance = localStorage.getItem(\"empire_user_balance\");\r\n    if (savedBalance) setUserCoinBalance(Number(savedBalance));\r\n\r\n    setIsInitialized(true);\r\n\r\n    // âœ¨ LISTEN FOR HUD UPDATES: This ensures when they sync in the pill, \r\n    // the cart context sees the new balance immediately.\r\n    const handleStorageChange = () => {\r\n      const updatedBalance = localStorage.getItem(\"empire_user_balance\");\r\n      if (updatedBalance) setUserCoinBalance(Number(updatedBalance));\r\n    };\r\n\r\n    window.addEventListener(\"storage\", handleStorageChange);\r\n    // Poll for changes every 2 seconds for same-tab updates\r\n    const interval = setInterval(handleStorageChange, 2000);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"storage\", handleStorageChange);\r\n      clearInterval(interval);\r\n    };\r\n  }, []);\r\n\r\n  // 2. PERSIST CART\r\n  useEffect(() => {\r\n    if (isInitialized) {\r\n      localStorage.setItem(\"storelink_cart\", JSON.stringify(cart));\r\n    }\r\n  }, [cart, isInitialized]);\r\n\r\n  const addToCart = (product: Product, store: Store) => {\r\n    setCart((prev) => {\r\n      const existing = prev.find((item) => item.product.id === product.id);\r\n      if (existing) {\r\n        return prev.map((item) =>\r\n          item.product.id === product.id ? { ...item, qty: item.qty + 1 } : item\r\n        );\r\n      }\r\n      return [...prev, { product, store, qty: 1 }];\r\n    });\r\n  };\r\n\r\n  const removeFromCart = (productId: string) => {\r\n    setCart((prev) => prev.filter((item) => item.product.id !== productId));\r\n  };\r\n\r\n  const updateQuantity = (productId: string, quantity: number) => {\r\n    setCart((prev) => \r\n      prev.map((item) => \r\n        item.product.id === productId \r\n          ? { ...item, qty: Math.max(1, quantity) } \r\n          : item\r\n      )\r\n    );\r\n  };\r\n\r\n  const clearCart = () => {\r\n    setCart([]);\r\n    setUseCoins(false);\r\n  };\r\n\r\n  const openCart = () => setIsCartOpen(true);\r\n  const closeCart = () => setIsCartOpen(false);\r\n\r\n  // --- CALCULATIONS ---\r\n\r\n  const cartCount = cart.reduce((acc, item) => acc + item.qty, 0);\r\n\r\n  const cartTotal = cart.reduce((total, item) => {\r\n    return total + (item.product.price * item.qty);\r\n  }, 0);\r\n\r\n  // --- âœ¨ EMPIRE 15% SAFETY LOGIC ---\r\n  \r\n  // Calculate the ceiling (Max discount allowed is 15% of cart total)\r\n  const MAX_DISCOUNT_PERCENTAGE = 0.15;\r\n  const maxAllowedDiscount = Math.floor(cartTotal * MAX_DISCOUNT_PERCENTAGE);\r\n\r\n  // Determine how many coins we can actually apply\r\n  // It's either their whole balance OR the 15% cap, whichever is smaller.\r\n  const coinsToRedeem = useCoins \r\n    ? Math.min(userCoinBalance, maxAllowedDiscount) \r\n    : 0;\r\n\r\n  const finalTotal = cartTotal - coinsToRedeem;\r\n\r\n  return (\r\n    <CartContext.Provider\r\n      value={{\r\n        cart,\r\n        cartCount,\r\n        cartTotal,\r\n        finalTotal,\r\n        isCartOpen,\r\n        setIsCartOpen,\r\n        addToCart,\r\n        removeFromCart,\r\n        updateQuantity,\r\n        clearCart,\r\n        openCart,\r\n        closeCart,\r\n        useCoins,\r\n        setUseCoins,\r\n        redeemableCoins: coinsToRedeem, // Amount subtracted from price\r\n        actualBalance: userCoinBalance, // Total in their bank\r\n      }}\r\n    >\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n}\r\n\r\nexport const useCart = () => {\r\n  const context = useContext(CartContext);\r\n  if (!context) throw new Error(\"useCart must be used within a CartProvider\");\r\n  return context;\r\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/lib/supabase.ts"],"sourcesContent":["import { createBrowserClient } from '@supabase/ssr'\r\n\r\n\r\nexport const supabase = createBrowserClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n)"],"names":[],"mappings":";;;;AAIE;AAJF;AAAA;;AAGO,MAAM,WAAW,IAAA,oMAAmB"}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/components/shared/GlobalCartSidebar.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useCart } from \"@/context/CartContext\";\r\nimport { \r\n  X, ShoppingBag, MessageCircle, User, Trash2, Loader2, \r\n  Coins, Zap, CheckCircle2 \r\n} from \"lucide-react\";\r\nimport Image from \"next/image\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { usePathname } from \"next/navigation\";\r\n\r\nexport default function GlobalCartSidebar() {\r\n  const { \r\n    cart, \r\n    isCartOpen, \r\n    setIsCartOpen, \r\n    removeFromCart, \r\n    useCoins,\r\n    setUseCoins,\r\n    actualBalance \r\n  } = useCart();\r\n\r\n  const pathname = usePathname();\r\n  const [formData, setFormData] = useState({\r\n    name: \"\",\r\n    phone: \"\",\r\n    address: \"\"\r\n  });\r\n\r\n  const [loadingStoreId, setLoadingStoreId] = useState<string | null>(null);\r\n\r\n  // âœ¨ AUDIT: Hooks MUST be called here, at the top level\r\n  useEffect(() => {\r\n    const saved = localStorage.getItem(\"storelink_billing\");\r\n    if (saved) {\r\n      try {\r\n        setFormData(JSON.parse(saved));\r\n      } catch (e) {\r\n        console.error(\"Billing parse error\", e);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // âœ¨ AUDIT: Move the \"Hide Logic\" AFTER all Hooks\r\n  const isInternalPage = pathname?.startsWith('/dashboard') || pathname?.startsWith('/admin');\r\n  \r\n  // If it's an internal page or the cart is closed, return null down here\r\n  if (isInternalPage || !isCartOpen) return null;\r\n\r\n  const handleChange = (field: string, value: string) => {\r\n    const newData = { ...formData, [field]: value };\r\n    setFormData(newData);\r\n    localStorage.setItem(\"storelink_billing\", JSON.stringify(newData));\r\n  };\r\n\r\n  const cartByVendor = cart.reduce((acc, item) => {\r\n    const storeId = item.store.id;\r\n    if (!acc[storeId]) acc[storeId] = { store: item.store, items: [] };\r\n    acc[storeId].items.push(item);\r\n    return acc;\r\n  }, {} as Record<string, { store: any, items: any[] }>);\r\n\r\n  const handleCheckout = async (storeId: string, storeData: any, items: any[]) => {\r\n    setLoadingStoreId(storeId); \r\n\r\n    try {\r\n        const storeTotal = items.reduce((sum: number, i: any) => sum + (i.product.price * i.qty), 0);\r\n        const MAX_DISCOUNT_PERCENT = 0.15;\r\n        const maxAllowedDiscount = Math.floor(storeTotal * MAX_DISCOUNT_PERCENT);\r\n        \r\n        const coinsToApply = useCoins ? Math.min(actualBalance, maxAllowedDiscount) : 0;\r\n        const finalPayable = storeTotal - coinsToApply;\r\n        \r\n        const earnedFromThis = storeData.loyalty_enabled \r\n          ? Math.floor(finalPayable * (storeData.loyalty_percentage / 100)) \r\n          : 0;\r\n        \r\n        const orderItemsForRPC = items.map((item: any) => ({\r\n            product_id: item.product.id,\r\n            product_name: item.product.name,\r\n            quantity: item.qty,\r\n            price: item.product.price\r\n        }));\r\n\r\n        const { data: newOrderId, error } = await supabase.rpc('create_new_order', {\r\n            store_uuid: storeId,\r\n            customer_name: formData.name,\r\n            customer_phone: formData.phone,\r\n            customer_email: null, \r\n            customer_address: formData.address,\r\n            total_amount_paid: finalPayable,\r\n            coins_used: coinsToApply,\r\n            order_items_array: orderItemsForRPC,\r\n        });\r\n\r\n        if (error) throw error;\r\n\r\n        if (coinsToApply > 0) {\r\n          await supabase.rpc('decrement_wallet', { \r\n            phone: formData.phone, \r\n            amount: coinsToApply \r\n          });\r\n        }\r\n        if (earnedFromThis > 0) {\r\n          await supabase.rpc('increment_wallet', { \r\n            phone: formData.phone, \r\n            amount: earnedFromThis,\r\n            c_name: formData.name\r\n          });\r\n        }\r\n\r\n        let cleanNumber = storeData.whatsapp_number?.replace(/\\D/g, '') || \"\";\r\n        if (cleanNumber.startsWith('0')) cleanNumber = '234' + cleanNumber.substring(1);\r\n\r\n        const itemLines = items.map((i: any) => `- ${i.qty}x ${i.product.name} (â‚¦${(i.product.price * i.qty).toLocaleString()})`).join('\\n');\r\n        \r\n        const msg = `*New Order #${newOrderId.slice(0,8)}* ðŸ“¦\\n\\n` +\r\n                    `Hello ${storeData.name}, I'd like to place an order:\\n\\n${itemLines}\\n\\n` +\r\n                    `*Subtotal: â‚¦${storeTotal.toLocaleString()}*\\n` +\r\n                    (coinsToApply > 0 ? `*Empire Discount (15% Max): -â‚¦${coinsToApply.toLocaleString()}*\\n` : \"\") +\r\n                    `*Total Payable: â‚¦${finalPayable.toLocaleString()}*\\n\\n` +\r\n                    `*Delivery Details:*\\nName: ${formData.name}\\nPhone: ${formData.phone}\\nAddress: ${formData.address}\\n\\n` +\r\n                    `I've applied my Empire Coins for a discount. Please send payment details and delivery timeline!`;\r\n        \r\n        window.open(`https://wa.me/${cleanNumber}?text=${encodeURIComponent(msg)}`, \"_blank\");\r\n        \r\n        items.forEach((item: any) => removeFromCart(item.product.id));\r\n        if (cart.length === items.length) setIsCartOpen(false);\r\n\r\n    } catch (err: any) {\r\n        console.error(\"Checkout Failed:\", err);\r\n        alert(`Failed to save order: ${err.message}`);\r\n    } finally {\r\n        setLoadingStoreId(null); \r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex justify-end animate-in fade-in duration-200\">\r\n      <div className=\"absolute inset-0\" onClick={() => setIsCartOpen(false)}></div>\r\n\r\n      <div className=\"relative w-full max-w-md bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300\">\r\n        <div className=\"p-5 border-b border-gray-100 flex justify-between items-center bg-white z-10\">\r\n           <h2 className=\"font-black text-xl flex items-center gap-2 uppercase tracking-tighter\">\r\n             <ShoppingBag className=\"text-emerald-600\" /> My Bag ({cart.length})\r\n           </h2>\r\n           <button onClick={() => setIsCartOpen(false)} className=\"p-2 bg-gray-50 rounded-full hover:bg-gray-100 transition\">\r\n             <X size={20} />\r\n           </button>\r\n        </div>\r\n\r\n        <div className=\"flex-1 overflow-y-auto p-5 bg-gray-50\">\r\n          {cart.length === 0 ? (\r\n            <div className=\"h-full flex flex-col items-center justify-center text-gray-400 opacity-60\">\r\n               <ShoppingBag size={64} className=\"mb-4\" />\r\n               <p className=\"font-bold uppercase text-xs tracking-widest\">Your bag is empty</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-6\">\r\n               <div className=\"bg-white p-5 rounded-[2.5rem] shadow-sm border border-gray-100\">\r\n                  <h3 className=\"font-black text-gray-900 mb-4 text-[10px] uppercase tracking-widest flex items-center gap-2\">\r\n                    <User size={14} className=\"text-emerald-500\" /> Billing Details\r\n                  </h3>\r\n                  <div className=\"space-y-3\">\r\n                    <input \r\n                      placeholder=\"Your Name\" \r\n                      className=\"w-full p-4 bg-gray-50 border-none rounded-2xl text-sm focus:ring-2 focus:ring-emerald-500 font-bold outline-none\"\r\n                      value={formData.name}\r\n                      onChange={e => handleChange(\"name\", e.target.value)}\r\n                    />\r\n                    <input \r\n                      placeholder=\"WhatsApp Number\" \r\n                      className=\"w-full p-4 bg-gray-50 border-none rounded-2xl text-sm focus:ring-2 focus:ring-emerald-500 font-bold outline-none\"\r\n                      value={formData.phone}\r\n                      onChange={e => handleChange(\"phone\", e.target.value)}\r\n                    />\r\n                    <textarea \r\n                      placeholder=\"Full Delivery Address\" \r\n                      className=\"w-full p-4 bg-gray-50 border-none rounded-2xl text-sm focus:ring-2 focus:ring-emerald-500 resize-none h-24 font-bold outline-none\"\r\n                      value={formData.address}\r\n                      onChange={e => handleChange(\"address\", e.target.value)}\r\n                    />\r\n                  </div>\r\n               </div>\r\n\r\n               {actualBalance > 0 && (\r\n                 <div className={`p-5 rounded-[2.5rem] border-2 transition-all duration-500 flex items-center justify-between ${useCoins ? 'bg-amber-500 border-amber-400 shadow-xl shadow-amber-100' : 'bg-white border-gray-100'}`}>\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className={`${useCoins ? 'bg-white text-amber-500' : 'bg-amber-500 text-white'} p-2.5 rounded-2xl shadow-sm`}>\r\n                        <Coins size={20} fill=\"currentColor\"/>\r\n                      </div>\r\n                      <div>\r\n                        <p className={`text-[9px] font-black uppercase tracking-widest leading-none mb-1 ${useCoins ? 'text-white' : 'text-amber-600'}`}>Empire Balance</p>\r\n                        <p className={`text-base font-black ${useCoins ? 'text-white' : 'text-gray-900'}`}>â‚¦{actualBalance.toLocaleString()}</p>\r\n                      </div>\r\n                    </div>\r\n                    <button \r\n                      onClick={() => setUseCoins(!useCoins)}\r\n                      className={`px-5 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all active:scale-95 shadow-sm ${useCoins ? 'bg-white text-amber-600' : 'bg-amber-500 text-white'}`}\r\n                    >\r\n                      {useCoins ? \"Applied\" : \"Apply Coins\"}\r\n                    </button>\r\n                 </div>\r\n               )}\r\n\r\n               {Object.values(cartByVendor).map(({ store, items }) => {\r\n                 const storeTotal = items.reduce((sum, i) => sum + (i.product.price * i.qty), 0);\r\n                 const maxDiscount = Math.floor(storeTotal * 0.15);\r\n                 const discount = useCoins ? Math.min(actualBalance, maxDiscount) : 0;\r\n                 const finalTotal = storeTotal - discount;\r\n                 const earnedFromThis = store.loyalty_enabled \r\n                    ? Math.floor(finalTotal * (store.loyalty_percentage / 100)) \r\n                    : 0;\r\n\r\n                 const isFormValid = formData.name && formData.phone && formData.address;\r\n\r\n                 return (\r\n                   <div key={store.id} className=\"bg-white p-5 rounded-[2.5rem] shadow-sm border border-gray-100 overflow-hidden\">\r\n                      <div className=\"flex justify-between items-center border-b border-gray-50 pb-4 mb-4\">\r\n                         <h3 className=\"font-black text-sm uppercase tracking-tight\">{store.name}</h3>\r\n                         <div className=\"text-right\">\r\n                           {discount > 0 && <p className=\"text-[10px] text-gray-300 line-through\">â‚¦{storeTotal.toLocaleString()}</p>}\r\n                           <span className=\"text-emerald-600 font-black text-lg tracking-tighter\">â‚¦{finalTotal.toLocaleString()}</span>\r\n                         </div>\r\n                      </div>\r\n\r\n                      <div className=\"space-y-4 mb-6\">\r\n                        {items.map(item => (\r\n                          <div key={item.product.id} className=\"flex gap-4 items-center\">\r\n                             <div className=\"relative w-12 h-12 bg-gray-50 rounded-xl overflow-hidden shrink-0 border border-gray-100\">\r\n                                {item.product.image_urls?.[0] && (\r\n                                  <Image src={item.product.image_urls[0]} alt=\"\" fill className=\"object-cover\" />\r\n                                )}\r\n                             </div>\r\n                             <div className=\"flex-1\">\r\n                                <p className=\"font-bold text-[13px] text-gray-900 line-clamp-1\">{item.product.name}</p>\r\n                                <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{item.qty} x â‚¦{item.product.price.toLocaleString()}</p>\r\n                             </div>\r\n                             <button onClick={() => removeFromCart(item.product.id)} className=\"text-gray-200 hover:text-red-500 transition-colors p-2\">\r\n                                <Trash2 size={16} />\r\n                             </button>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n\r\n                      {discount > 0 && (\r\n                        <div className=\"mb-4 bg-amber-50 border border-amber-100 p-3 rounded-2xl flex justify-between items-center text-[10px] font-black uppercase text-amber-700\">\r\n                           <span className=\"flex items-center gap-1.5\"><CheckCircle2 size={12}/> Empire Discount</span>\r\n                           <span>-â‚¦{discount.toLocaleString()}</span>\r\n                        </div>\r\n                      )}\r\n\r\n                      {earnedFromThis > 0 && (\r\n                        <div className=\"bg-emerald-50 text-emerald-700 text-[10px] font-black p-3 rounded-2xl mb-6 flex items-center gap-2 border border-emerald-100\">\r\n                           <Zap size={14} fill=\"currentColor\" className=\"animate-pulse\" /> You'll earn +â‚¦{earnedFromThis.toLocaleString()} Coins\r\n                        </div>\r\n                      )}\r\n\r\n                      <button \r\n                        onClick={() => handleCheckout(store.id, store, items)}\r\n                        disabled={!isFormValid || loadingStoreId === store.id}\r\n                        className=\"w-full bg-gray-900 text-white py-4 rounded-[1.5rem] font-black text-[11px] uppercase tracking-[0.1em] hover:bg-emerald-600 transition-all disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-not-allowed shadow-xl shadow-gray-100 flex items-center justify-center gap-2\"\r\n                      >\r\n                        {loadingStoreId === store.id ? (\r\n                           <Loader2 className=\"animate-spin\" size={18} />\r\n                        ) : (\r\n                           <><MessageCircle size={16} /> Checkout on WhatsApp</>\r\n                        )}\r\n                      </button>\r\n                   </div>\r\n                 );\r\n               })}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 790, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaelo/store-link/components/shared/EmpireWalletHUD.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { \r\n  Coins, \r\n  X, \r\n  Wallet, \r\n  CheckCircle2, \r\n  ChevronRight, \r\n  RefreshCw \r\n} from \"lucide-react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport { motion } from \"framer-motion\"; // âœ¨ For floating/swiping logic\r\n\r\nexport default function EmpireWalletHUD() {\r\n  const pathname = usePathname();\r\n  const constraintsRef = useRef(null); // Ref for draggable area\r\n\r\n  // --- STATES ---\r\n  const [balance, setBalance] = useState<number | null>(null);\r\n  const [customerName, setCustomerName] = useState<string | null>(null);\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [isSynced, setIsSynced] = useState(false);\r\n\r\n  // 1. âœ¨ HIDE LOGIC\r\n  const isInternalPage = pathname?.startsWith('/dashboard') || pathname?.startsWith('/admin');\r\n  if (isInternalPage) return null;\r\n  \r\n  // 2. âœ¨ PERSISTENCE & INITIAL LOAD\r\n  useEffect(() => {\r\n    const savedPhone = localStorage.getItem(\"empire_user_phone\");\r\n    const savedName = localStorage.getItem(\"empire_user_name\");\r\n    \r\n    if (savedName) setCustomerName(savedName);\r\n    if (savedPhone) {\r\n      setPhone(savedPhone);\r\n      fetchBalance(savedPhone);\r\n    }\r\n  }, []);\r\n\r\n  // 3. âœ¨ SYNC LOGIC (Force Balance Update)\r\n  const fetchBalance = async (phoneNumber: string) => {\r\n    if (!phoneNumber) return;\r\n    setLoading(true);\r\n    try {\r\n      // Calling the RPC we created earlier\r\n      const { data, error } = await supabase\r\n        .rpc('sync_or_create_wallet', { phone: phoneNumber });\r\n\r\n      if (data && data.length > 0) {\r\n        const wallet = data[0];\r\n        \r\n        setBalance(wallet.balance);\r\n        setCustomerName(wallet.c_name);\r\n        setIsSynced(true);\r\n        \r\n        localStorage.setItem(\"empire_user_phone\", phoneNumber);\r\n        localStorage.setItem(\"empire_user_balance\", wallet.balance.toString());\r\n        if (wallet.c_name) localStorage.setItem(\"empire_user_name\", wallet.c_name);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Empire Sync Error:\", error);\r\n      setBalance(0);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCheck = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (phone.length > 8) fetchBalance(phone);\r\n  };\r\n\r\n  return (\r\n    <div ref={constraintsRef} className=\"fixed inset-0 pointer-events-none z-[50]\">\r\n      \r\n      <motion.div\r\n        layout\r\n        drag\r\n        dragDirectionLock\r\n        dragConstraints={constraintsRef}\r\n        dragElastic={0.1}\r\n        dragMomentum={false}\r\n        style={{ touchAction: \"none\" }} \r\n        className=\"pointer-events-auto cursor-grab active:cursor-grabbing absolute flex flex-col items-end gap-2\"\r\n       >\r\n        \r\n        <button \r\n          onClick={() => setIsOpen(!isOpen)}\r\n          className=\"bg-white/90 backdrop-blur-md border-2 border-amber-100 shadow-2xl rounded-2xl flex items-center justify-center transition-all active:scale-95 group h-[42px] w-[42px] md:h-auto md:w-auto md:px-4 md:py-2 md:gap-2\"\r\n        >\r\n          <div className=\"bg-amber-500 p-1.5 rounded-xl text-white shadow-lg shadow-amber-200 shrink-0\">\r\n            <Coins size={18} fill=\"currentColor\" />\r\n          </div>\r\n          \r\n          <div className=\"text-left hidden md:block\">\r\n            <p className=\"text-[8px] font-black text-amber-600 uppercase tracking-widest leading-none\">Empire Wallet</p>\r\n            <p className=\"text-sm font-black text-gray-900 leading-tight\">\r\n              {balance !== null ? `â‚¦${balance.toLocaleString()}` : \"Sync Wallet\"}\r\n            </p>\r\n          </div>\r\n\r\n          {/* Mobile Balance Peek */}\r\n          {balance !== null && balance > 0 && (\r\n            <div className=\"md:hidden pr-1\">\r\n               <p className=\"text-[10px] font-black text-gray-900\">\r\n                 {balance > 999 ? `${(balance/1000).toFixed(1)}k` : `â‚¦${balance}`}\r\n               </p>\r\n            </div>\r\n          )}\r\n        </button>\r\n\r\n        {/* âœ¨ THE DROPDOWN CARD */}\r\n        {isOpen && (\r\n          <div className=\"bg-white border border-gray-100 shadow-2xl rounded-[2.5rem] p-6 w-[88vw] max-w-[320px] animate-in slide-in-from-top-4 duration-300\">\r\n            <div className=\"flex justify-between items-center mb-5\">\r\n              <h3 className=\"font-black text-gray-900 uppercase text-[10px] tracking-widest flex items-center gap-2\">\r\n                <Wallet size={14} className=\"text-amber-500\" /> My Empire Savings\r\n              </h3>\r\n              <button onClick={() => setIsOpen(false)} className=\"p-2 bg-gray-50 rounded-full text-gray-300 hover:text-gray-900 transition-colors\">\r\n                <X size={16}/>\r\n              </button>\r\n            </div>\r\n\r\n            {!isSynced ? (\r\n              <form onSubmit={handleCheck} className=\"space-y-4\">\r\n                <input \r\n                  type=\"tel\" \r\n                  placeholder=\"WhatsApp Number\"\r\n                  value={phone}\r\n                  onChange={(e) => setPhone(e.target.value)}\r\n                  className=\"w-full bg-gray-50 border-2 border-transparent rounded-2xl px-5 py-4 text-sm font-bold focus:bg-white focus:border-amber-500 transition-all outline-none\"\r\n                />\r\n                <button \r\n                  disabled={loading}\r\n                  className=\"w-full bg-gray-900 text-white py-4 rounded-2xl font-black text-[11px] uppercase tracking-widest hover:bg-amber-600 transition-all shadow-xl shadow-gray-200 active:scale-95 disabled:opacity-50\"\r\n                >\r\n                  {loading ? \"Syncing...\" : \"Access My Balance\"}\r\n                </button>\r\n              </form>\r\n            ) : (\r\n              <div className=\"animate-in zoom-in duration-300\">\r\n                <div className=\"p-5 bg-emerald-50 rounded-[2rem] text-center border border-emerald-100 mb-4\">\r\n                  <p className=\"text-[9px] font-black text-emerald-600/60 uppercase tracking-widest mb-1\">\r\n                    {customerName ? `Welcome, ${customerName.split(' ')[0]}` : \"Current Balance\"}\r\n                  </p>\r\n                  <p className=\"text-3xl font-black text-emerald-700 tracking-tighter\">â‚¦{balance?.toLocaleString() || 0}</p>\r\n                </div>\r\n                <button \r\n                  onClick={() => setIsSynced(false)}\r\n                  className=\"flex items-center gap-2 mx-auto text-[10px] font-bold text-gray-400 uppercase tracking-widest hover:text-amber-600 transition-colors\"\r\n                >\r\n                  <RefreshCw size={12} /> Switch Number\r\n                </button>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"mt-6 space-y-3 pt-5 border-t border-gray-100\">\r\n               <div className=\"flex items-start gap-2\">\r\n                  <CheckCircle2 size={14} className=\"text-emerald-500 shrink-0 mt-0.5\" />\r\n                  <p className=\"text-[10px] text-gray-500 font-medium leading-tight\">1 Empire Coin = â‚¦1 Discount.</p>\r\n               </div>\r\n               <div className=\"flex items-start gap-2\">\r\n                  <CheckCircle2 size={14} className=\"text-emerald-500 shrink-0 mt-0.5\" />\r\n                  <p className=\"text-[10px] text-gray-500 font-medium leading-tight\">Redeem up to 15% per order.</p>\r\n               </div>\r\n            </div>\r\n            \r\n            <div className=\"mt-6 pt-4\">\r\n              <Link \r\n                href=\"/empire-coins\" \r\n                onClick={() => setIsOpen(false)}\r\n                className=\"flex items-center justify-between w-full bg-gray-50 p-4 rounded-2xl group hover:bg-amber-50 transition-colors\"\r\n              >\r\n                <div className=\"text-left\">\r\n                  <p className=\"text-[10px] font-black text-gray-900 uppercase tracking-tighter\">Empire Manual</p>\r\n                  <p className=\"text-[10px] text-gray-400 font-bold\">How it works</p>\r\n                </div>\r\n                <ChevronRight size={16} className=\"text-gray-300 group-hover:text-amber-500 group-hover:translate-x-1 transition-all\" />\r\n              </Link>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </motion.div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}